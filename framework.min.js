/*! @preserve
* Copyright (c) meta.morph Medien GmbH 2015
* All Rights Reserved.
* 
* No part of this source code or any of its contents may be reproduced, 
* copied, modified or adapted, without the prior written consent of the 
* author, unless otherwise indicated for stand-alone materials.
*
* Commercial use and distribution of this source code is not allowed 
* without express and prior written consent of the author.
*/
function jsonp_callback(result){window.adCallback&&window.adCallback(result)}this.JST=this.JST||{},this.JST["framework/player/androidtv"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<video id="player_object" autoplay autobuffer preload="metadata" width="0px" height="0px"></video>';return __p},this.JST["framework/player/cehtml"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<div id=\'player_div\'><object id="video_player" type="'+(null==(__t=type)?"":__t)+'" data="'+(null==(__t=url)?"":__t)+'" height="0px" width="0px" top="0px" left="0px"></object></div>';return __p},this.JST["framework/player/cehtml_video_object"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<object id="video_player" type="'+(null==(__t=type)?"":__t)+'" data="'+(null==(__t=url)?"":__t)+'" height="0px" width="0px" top="0px" left="0px"></object>';return __p},this.JST["framework/player/firetv"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<video id="player_object" autoplay autobuffer preload="metadata" width="0px" height="0px"></video>';return __p},this.JST["framework/player/generic"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<object id="player_object" type="'+(null==(__t=type)?"":__t)+'" data="'+(null==(__t=url)?"":__t)+'" style="display: none;"></object>';return __p},this.JST["framework/player/html5"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<video id="player_object" width="0px" height="0px" preload="none"></video>';return __p},this.JST["framework/player/samsung"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+="";return __p},this.JST["framework/player/samsung_tizen"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<OBJECT id="player_object" type="application/avplayer"></OBJECT>';return __p};var Logger={logToHTML:!1,logToConsole:!1,logToAlert:!1,logToHTMLFromSetup:!1,logToConsoleFromSetup:!1,logToAlertFromSetup:!1,isExclusive:!1,remoteUrl:null,remoteMethod:null,remoteLevel:null,LEVEL:["debug","info","warn","error"]};Logger.setup=function(_logToHTML,_logToConsole,_logToAlert){_logToHTML&&(Logger.logToHTML=!0,Logger.logToHTMLFromSetup=!0,window.onerror=function(msg,url,line){Logger.error("OnError: "+msg+"\nurl: "+url+"\nline #: "+line);var suppressErrorAlert=!1;return suppressErrorAlert}),_logToConsole&&(Logger.logToConsole=!0,Logger.logToConsoleFromSetup=!0),_logToAlert&&(Logger.logToAlert=!0,Logger.logToAlertFromSetup=!0)},Logger.setupRemote=function(url,method,level){Logger.remoteUrl=url,Logger.remoteMethod=null!==method&&void 0!=method?method:"get",Logger.remoteLevel=null!==level&&void 0!=level?Logger.LEVEL.indexOf(level):"debug"},Logger.remoteLog=function(level,message){null!==message&&void 0!=message&&null!==Logger.remoteUrl&&Logger.remoteLevel<=Logger.LEVEL.indexOf(level)&&(void 0!=message.innerHTML&&(message=message.innerHTML),$.ajax({url:Logger.remoteUrl,method:Logger.remoteMethod,data:{message:message}}))},Logger.show=function(){Logger.logToHTML&&(document.getElementById("Console").style.display="block")},Logger.hide=function(){Logger.logToHTML&&(document.getElementById("Console").style.display="none")},Logger.log=function(txt){Logger.remoteLog("debug",txt),Logger.logToHTML&&(document.getElementById("Console").innerHTML+='<br/><span class="log">'+txt+"</span>"),Logger.logToConsole&&console.log(txt),Logger.logToAlert&&alert(txt)},Logger.logExclusive=function(txt){Logger.remoteLog("debug",txt),Logger.logToHTMLFromSetup&&(Logger.isExclusive||(document.getElementById("Console").innerHTML="just exlusive logs...",Logger.isExclusive=!0,Logger.logToHTML=!1),document.getElementById("Console").innerHTML+="<br/>"+txt),Logger.logToConsoleFromSetup&&(console.log(txt),Logger.logToConsole=!1),Logger.logToAlertFromSetup&&alert(txt)},Logger.logLast=function(txt){Logger.remoteLog("debug",txt),Logger.logToHTMLFromSetup&&(document.getElementById("Console").innerHTML+="<br/>"+txt),Logger.logToConsoleFromSetup&&console.log(txt),Logger.logToAlertFromSetup&&alert(txt),Logger.logToHTML=!1,Logger.logToConsole=!1,Logger.logToAlert=!1,Logger.logToHTMLFromSetup=!1,Logger.logToConsoleFromSetup=!1,Logger.logToAlertFromSetup=!1},Logger.info=function(txt){Logger.remoteLog("info",txt),Logger.logToHTML&&(document.getElementById("Console").innerHTML+='<br/><span class="info">'+txt+"</span>"),Logger.logToConsole&&console.info(txt),Logger.logToAlert&&alert(txt)},Logger.warn=function(txt){Logger.remoteLog("warn",txt),Logger.logToHTML&&(document.getElementById("Console").innerHTML+='<br/><span class="warn">'+txt+"</span>"),Logger.logToConsole&&console.warn(txt),Logger.logToAlert&&alert(txt)},Logger.debug=function(txt){Logger.remoteLog("debug",txt),Logger.logToHTML&&(document.getElementById("Console").innerHTML+='<br/><span class="debug">'+txt+"</span>"),Logger.logToConsole&&console.debug(txt),Logger.logToAlert&&alert(txt)},Logger.error=function(txt){Logger.remoteLog("error",txt),Logger.logToHTML&&(document.getElementById("Console").innerHTML+='<br/><span class="error">'+txt+"</span>"),Logger.logToConsole&&console.error(txt),Logger.logToAlert&&alert(txt)};var SYSTEM_TYPE={TV:0,MONITOR:1,BD:2};"undefined"!=typeof klass&&$.klass&&(klass=$.klass);var Util={};Util.getFancyTime=function(time){if(0===time)return"00:00:00";var hours=Math.floor(time/3600);time-=3600*hours;var minutes=Math.floor(time/60);time-=60*minutes;var seconds=parseInt(time%60,10);return(10>hours?"0"+hours:hours)+":"+(10>minutes?"0"+minutes:minutes)+":"+(10>seconds?"0"+seconds:seconds)},Util.getCurrentSystemType=function(){var result=SYSTEM_TYPE.BD,location=window.location.search;if(""!==location){"?"==location.substring(0,1)&&(location=location.substring(1,location.length));var locations=location.split("&");if(locations.length>0)for(var i=0;i<locations.length;i++){var values=locations[i].split("=");if(""!==values[0]&&""!==values[1]&&"product"==values[0]){result=values[1];break}}}return result},Util.isBD=function(){return Util.getCurrentSystemType()==SYSTEM_TYPE.BD},Util.defined=function(_val){var result=!1;return void 0!=_val&&null!==_val&&(result=!0),result},Util.html=function(pDiv,pContents){if(null!==pDiv){for(;pDiv.firstChild;)if(pDiv.deleteChild)try{pDiv.deleteChild(pDiv.firstChild)}catch(e){}else try{pDiv.removeChild(pDiv.firstChild)}catch(e){}"string"==typeof pContents?pDiv.innerHTML=pContents:pDiv.appendChild(pContents)}},Util.append=function(pDiv,pContents,considerXHTMLTags){null!==pDiv&&("string"==typeof pContents?Util.appendHTML(pDiv,pContents,considerXHTMLTags):pDiv.appendChild(pContents))},Util.appendHTML=function(pDiv,pContents,considerXHTMLTags){if(null!==pDiv){var formerInnerHTML="";try{formerInnerHTML=pDiv.innerHTML}catch(e){Logger.log("Util.append: ERROR: "+e)}for(considerXHTMLTags&&(formerInnerHTML=formerInnerHTML.replace(/(<div\s[^(\/>)]*)\/>/g,"$1></div>"));pDiv.firstChild;)if(pDiv.deleteChild)try{pDiv.deleteChild(pDiv.firstChild)}catch(e){}else try{pDiv.removeChild(pDiv.firstChild)}catch(e){}pDiv.innerHTML=formerInnerHTML+pContents}},Util.trim=function(str){return str.replace(/^\s+|\s+$/g,"")},Util.stripHTML=function(oldString){var newString="",inTag=!1;if(oldString)for(var i=0;i<oldString.length;i++)"<"==oldString.charAt(i)?inTag=!0:">"==oldString.charAt(i)&&"<"!=oldString.charAt(i+1)&&(inTag=!1,i++,newString+=" "),inTag||(newString+=oldString.charAt(i));return newString},Util.sizeOf=function(obj){var key,size=0;for(key in obj)obj.hasOwnProperty(key)&&size++;return size},Util.bind=function(scope,fn,arguments){return function(){fn.apply(scope,arguments)}},Util.zeroPad=function(num,width){for(num=num.toString();num.length<width;)num="0"+num;return num},Util.preloadImages=function(urlArr,imageArrayRef){var prelImgsLength=imageArrayRef.length;for(i=0;i<urlArr.length;i++)imageArrayRef[prelImgsLength+i]=document.createElement("img"),imageArrayRef[prelImgsLength+i].src=urlArr[i]},Util.stripTags=function(input,allowed){allowed=(((allowed||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var tags=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,commentsAndPhpTags=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return input?input.replace(commentsAndPhpTags,"").replace(tags,function($0,$1){return allowed.indexOf("<"+$1.toLowerCase()+">")>-1?$0:""}):input},Util.addKeyframe=function(keyframes){if(document.styleSheets&&document.styleSheets.length)document.styleSheets[0].insertRule(keyframes,0);else{var s=document.createElement("style");s.innerHTML=keyframes,document.getElementsByTagName("head")[0].appendChild(s)}},Util.match=function(_haystack,_stringToMatch,_caseInsensitive,_useRegex){return"undefined"!=typeof _useRegex&&_useRegex?_haystack.search(_stringToMatch)>-1?!0:!1:"undefined"!=typeof _caseInsensitive&&_caseInsensitive?_haystack.toLowerCase().indexOf(String(_stringToMatch).toLowerCase())>-1?!0:!1:_haystack.indexOf(_stringToMatch)>-1?!0:!1};var HistoryState=klass({initialize:function(_options){this.callbackFunction=_options.callbackFunction?_options.callbackFunction:null,this.callbackParams=_options.callbackParams?_options.callbackParams:{},this.callbackParams.fromBack=!0,this.clear=_options.clear?_options.clear:!1}}),HistoryManager=klass({initialize:function(_device){_.extend(this,Backbone.Events),this.device=_device,this.states=[],Logger.log("HistoryManager initialized"),this.device instanceof Html5Device&&(this.html5HistoryDummyStateActive=!1,window.history&&window.history.pushState&&"function"==typeof window.history.pushState&&!this.html5HistoryDummyStateActive&&(Logger.log("pushing a new state"),window.history.pushState("_state",""),this.html5HistoryDummyStateActive=!0),window.addEventListener("popstate",Util.bind(this,function(event){Logger.log("popstate triggered"),this.html5HistoryDummyStateActive=!1,this.states.length<1&&!this.html5HistoryDummyStateActive&&(Logger.log("sending history empty event"),event.preventDefault(),this.trigger("history:empty")),this.html5HistoryDummyStateActive||(Logger.log("pushing a new state"),window.history.pushState("_state",""),this.html5HistoryDummyStateActive=!0)})))},push:function(_historyState){return Logger.log("history.push"),_historyState instanceof HistoryState?(_historyState.clear&&this.clear(),"function"==typeof _historyState.callbackFunction&&(this.states.push(_historyState),this.device instanceof Html5Device&&window.history&&window.history.pushState&&"function"==typeof window.history.pushState&&!this.html5HistoryDummyStateActive&&(Logger.log("pushing a new state"),window.history.pushState("_state",""),this.html5HistoryDummyStateActive=!0)),!0):!1},pop:function(){if(Logger.log("history.pop"),this.states.length>0){var lastState=this.states.pop();"function"==typeof lastState.callbackFunction&&(null==lastState.callbackParams?lastState.callbackFunction():lastState.callbackFunction(lastState.callbackParams))}else this.trigger("history:empty")},clear:function(){Logger.log("history.clear"),this.states=[]}}),BaseState=Backbone.Model.extend({initialize:function(owner){this.owner=owner},enter:function(){},execute:function(){},play:function(){Logger.log("changing to the playing state..."),this.owner.changeState(this.owner.states.playing)},stop:function(){Logger.log("changing to the stopping state..."),this.owner.changeState(this.owner.states.stopping)},pause:function(){Logger.log("changing to the pausing state..."),this.owner.changeState(this.owner.states.pausing)},exit:function(){}}),PlayingState=BaseState.extend({execute:function(){Logger.log("playing the video!"),this.owner.doPlay(),this.owner.trigger("player:switched_state:playing")},play:function(){Logger.log("already playing!")}}),StoppingState=BaseState.extend({enter:function(){Logger.log("we have entered the stopping state...")},execute:function(){Logger.log("stopping the video..."),this.owner.videoInfoObject=null,this.owner.doStop(),this.owner.trigger("player:switched_state:stopped")},stop:function(){Logger.log("already stopped!")},pause:function(){Logger.log("pause not possible!")}}),PausingState=BaseState.extend({execute:function(){Logger.log("pausing the video."),this.owner.doPause(),this.owner.trigger("player:switched_state:paused")},pause:function(){this.owner.changeState(this.owner.states.playing)}}),playerInstance=null,Player=Backbone.View.extend({tagName:"div",videoInfoObject:null,templateID:"framework/player/generic",template:null,recreate_on_play:!1,state:null,previousState:null,_hasBufferIndicator:!1,playerCurrentTime:-1,seekImmediatellyToPosition:!1,resumePlayDelay:0,initialize:function(_deviceInfo){this.deviceInfo=_deviceInfo,this.template=window.JST[this.templateID],this.states={},this.states.playing=new PlayingState(this),this.states.pausing=new PausingState(this),this.states.stopping=new StoppingState(this),this.setInitialState(),playerInstance=this},setInitialState:function(){Logger.log("Player setInitialState ..."),this.playerCurrentTime=-1,this.state=this.states.stopping},play:function(){Logger.log("Player play ..."),this.state.play()},pause:function(){Logger.log("Player pause ..."),this.state.pause()},stop:function(){Logger.log("Player stop ..."),this.state.stop()},playVideo:function(_videoInfoObject,_seekTo){this.videoInfoObject=_videoInfoObject,this.blockPauseState=!0,this.seekImmediatellyToPosition="undefined"!=typeof _seekTo?_seekTo:!1},buffering_started:function(){Logger.log("Player buffering_started ..."),this.trigger("player:buffering_started")},buffering_completed:function(){Logger.log("Player buffering_completed ..."),this.trigger("player:buffering_completed")},buffering_progress:function(_time){this.trigger("player:buffering_progress",_time)},time_update:function(_timeInSecs,_timeInDeviceFormat){this.blockPauseState&&(_timeInSecs>this.resumePlayDelay||_timeInDeviceFormat&&_timeInDeviceFormat>this.resumePlayDelay)&&(this.blockPauseState=!1,this.trigger("player:playback_started"),this.seekImmediatellyToPosition&&(this.playerCurrentTime=0,this.seek(this.seekImmediatellyToPosition),this.seekImmediatellyToPosition=!1)),this.playerCurrentTime=_timeInSecs,this.trigger("player:time_update",_timeInSecs)},duration_update:function(_time){this.trigger("player:duration_update",_time)},playback_ended:function(){Logger.log("Player playback_ended"),this.reset(),this.trigger("player:playback_ended")},fatal_error:function(){Logger.log("Player fatal_error ..."),this.reset(),this.trigger("player:fatal_error")},changeState:function(state){if(this.state!==state){if(state instanceof PausingState&&this.blockPauseState)return!1;this.state&&this.state.exit(),this.previousState=this.state,this.state=state,this.state.enter(this.previousState),this.state.execute()}return!0},toggle_play_pause:function(){Logger.log("toggle_play_pause..."),this.state instanceof PlayingState?this.pause():this.play()},reset:function(){this.stop(),this.seekImmediatellyToPosition=!1,this.setInitialState()},getRenderingContext:function(){return null!==this.videoInfoObject?{url:this.videoInfoObject.url,type:this.videoInfoObject.type}:{url:"",type:Player.VIDEO_TYPES.MP4}},render:function(){return this.$el.html(this.template(this.getRenderingContext())),this},hide:function(){this.$el.hide()},show:function(){this.$el.show()},setDisplayArea:function(){},seekTo:function(){},seek:function(timeInSeconds){var time=this.playerCurrentTime+timeInSeconds;0>time&&(time=0),this.seekTo(time)},doPlay:function(){},doPause:function(){},doStop:function(){},createVideoObject:function(_url,_type){return Logger.warn("createVideoObject is deprecated -> build your own videoInfoObject: {url: ..,type: ..}, for types see: Player.VIDEO_TYPES"),{url:_url,type:_type}},isPaused:function(){return this.state instanceof PausingState},isPlaying:function(){return this.state instanceof PlayingState},isStopped:function(){return this.state instanceof StoppingState},hasBufferIndicator:function(){return this._hasBufferIndicator}},{VIDEO_TYPES:{MP4:"video/mp4",HLS:"application/vnd.apple.mpegurl"}}),CEHTMLPlayer=Player.extend({templateID:"framework/player/cehtml",video_object_templateID:"framework/player/cehtml_video_object",recreate_on_play:!0,currentPlayTimeInterval:null,initialize:function(_deviceInfo){Logger.log("CEHTMLPlayer initialize ..."),Player.prototype.initialize.call(this,_deviceInfo),this.video_object_template=window.JST[this.video_object_templateID]},playStateChanged:function(){switch(Logger.log("CEHTMLPlayer playStateChanged ..."),Logger.log("CEHTMLPlayer playStateChanged this: "+this),Logger.log("CEHTMLPlayer playStateChanged this._playState: "+this.video_tag.playState),this.video_tag.playState){case 5:Logger.log("CEHTMLPlayer state: ended"),playerInstance.ended();break;case 6:Logger.log("CEHTMLPlayer state: error"),playerInstance.error();break;case 0:Logger.log("CEHTMLPlayer state: stopped");break;case 1:Logger.log("CEHTMLPlayer state: playing"),playerInstance.durationupdate(playerInstance.video_tag.playTime),playerInstance.buffering_completed(),playerInstance.startPlayPostionInterval();break;case 2:Logger.log("CEHTMLPlayer state: paused");break;case 3:Logger.log("CEHTMLPlayer state: connecting");break;case 4:Logger.log("CEHTMLPlayer state: buffering"),playerInstance.buffering_started();break;default:Logger.log("CEHTMLPlayer no state matched!!!")}},startPlayPostionInterval:function(){Logger.log("CEHTMLPlayer setPlayPostionTime ..."),playerInstance.currentPlayTimeInterval&&clearInterval(playerInstance.currentPlayTimeInterval),playerInstance.currentPlayTimeInterval=setInterval(function(){playerInstance.timeupdate(playerInstance.video_tag.playPosition)},200)},stopPlayPostionInterval:function(){Logger.log("CEHTMLPlayer stopPlayPostionInterval ..."),playerInstance&&playerInstance.currentPlayTimeInterval&&(clearInterval(playerInstance.currentPlayTimeInterval),playerInstance.currentPlayTimeInterval=null)},error:function(){Logger.log("CEHTMLPlayer error()"),playerInstance.videoInfoObject?this.fatal_error():Logger.log("CEHTML ERROR ignored --> we have no videoInfoObject")},onBuffering:function(_isBuffering){Logger.log("CEHTMLPlayer onBuffering() _isBuffering: "+_isBuffering),_isBuffering?playerInstance.buffering_started():playerInstance.buffering_completed()},ended:function(){Logger.log("CEHTMLPlayer ended()"),this.playback_ended()},timeupdate:function(_time){this.time_update(Math.floor(_time/1e3),_time)},durationupdate:function(_time){Logger.log("durationupdate: _time: "+_time),this.duration_update(Math.floor(_time/1e3))},show:function(){Logger.log("CEHTMLPlayer show"),this.video_tag.width=(this.videoWidth||1280)+"px",this.video_tag.height=(this.videoHeight||720)+"px"},hide:function(){Logger.log("CEHTMLPlayer hide"),this.video_tag.width="0px",this.video_tag.height="0px"},render:function(){return Logger.log("CEHTMLPlayer render"),Player.prototype.render.call(this),this.video_tag=$("#video_player",this.el)[0],this.player_div=$("#player_div",this.el)[0],this},playVideo:function(_videoInfoObject,_seekTo){var video_type_changed=!1;this.videoInfoObject&&this.videoInfoObject.type!=_videoInfoObject.type&&(video_type_changed=!0),Player.prototype.playVideo.call(this,_videoInfoObject,_seekTo),Logger.log(this.video_tag),video_type_changed&&(this.player_div.empty(),this.player_div.html(this.video_object_template({url:"",type:_videoInfoObject.type})),this.video_tag=$("#video_player",this.el)[0]),this.deviceInfo.vendor==VENDOR.LG?(Logger.log("CEHTMLPlayer setting LG callbacks ..."),this.video_tag.PlayStateChange=Util.bind(this,this.playStateChanged)):this.video_tag.onPlayStateChange=Util.bind(this,this.playStateChanged),this.video_tag.data=this.videoInfoObject.url,this.show(),this.play()},setDisplayArea:function(x,y,width,height){this.videoWidth=width,this.videoHeight=height,this.player_div.style.position="fixed",this.player_div.style.top=y+"px",this.player_div.style.left=x+"px",this.player_div.style.width=width+"px",this.player_div.style.height=height+"px",this.video_tag.style.width=width+"px",this.video_tag.style.height=height+"px",this.video_tag.width=width+"px",this.video_tag.height=height+"px"},seekTo:function(timeInSeconds){this.video_tag.seek(1e3*timeInSeconds)},doPlay:function(){Logger.log("CEHTML playing the video! "+this.video_tag.width+"/"+this.video_tag.height),Logger.log("CEHTML playing the video! "+this.video_tag.data),this.video_tag.play(1)},doPause:function(){Logger.log("CEHTML pausing the video."),this.video_tag.play(0)},doStop:function(){Logger.log("CEHTML stopping the video..."),this.stopPlayPostionInterval(),this.video_tag.stop(),this.video_tag.data=""}}),HTML5Player=Player.extend({useVideoSourceObject:!1,video_src_tag:null,video_tag:null,templateID:"framework/player/html5",recreate_on_play:!1,initialize:function(_deviceInfo){Player.prototype.initialize.call(this,_deviceInfo),this.useVideoSourceObject=_deviceInfo.useVideoSourceObject},bindPlayerEvents:function(){Logger.log("HTML5Player bindPlayerEvents ..."),this.video_tag.addEventListener("loadstart",Util.bind(this,this.loadstart),!1),this.video_tag.addEventListener("durationchange",Util.bind(this,this.durationchange),!1),this.video_tag.addEventListener("loadedmetadata",Util.bind(this,this.loadedmetadata),!1),this.video_tag.addEventListener("loadeddata",Util.bind(this,this.loadeddata),!1),this.video_tag.addEventListener("progress",Util.bind(this,this.progress),!1),this.video_tag.addEventListener("canplay",Util.bind(this,this.canplay),!1),this.video_tag.addEventListener("canplaythrough",Util.bind(this,this.canplaythrough),!1),this.video_tag.addEventListener("ended",Util.bind(this,this.ended),!1),this.video_tag.addEventListener("timeupdate",playerInstance.timeupdate,!1),this.video_tag.addEventListener("waiting",Util.bind(this,this.waiting),!1),this.video_tag.addEventListener("abort",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("suspend",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("emptied",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("seeked",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("seeking",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("playing",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("stalled",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("play",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("pause",Util.bind(this,this.other_event),!1),this.video_tag.addEventListener("error",Util.bind(this,this.error),!1)},render:function(){return Player.prototype.render.call(this),this.video_tag=$("#player_object",this.el)[0],this.bindPlayerEvents(),this},playVideo:function(_videoInfoObject,_seekTo){if(_videoInfoObject){if(Player.prototype.playVideo.call(this,_videoInfoObject,_seekTo),this.useVideoSourceObject){var videosrc=document.createElement("source");$(this.video_tag).empty().append(videosrc),this.video_src_tag=videosrc;var self=this;$(videosrc).on("error",function(event){self.error(event)})}else this.video_src_tag=this.video_tag;this.video_src_tag.type=this.videoInfoObject.type,this.video_src_tag.src=this.videoInfoObject.url,this.show(),this.video_tag.load(),this.play()}},error:function(event){if(Logger.log("HTML5 error event.type:"+event.type),Logger.log("HTML5 error event.target:"+event.target),null!=event.target.error)switch(Logger.log("HTML5 error event.target.error.code:"+event.target.error.code),event.target.error.code){case 1:Logger.log("The fetching process for the media resource was aborted by the user agent at the user's request");break;case 2:Logger.log("A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable");break;case 3:Logger.log("An error of some description occurred while decoding the media resource, after the resource was established to be usable");break;case 4:Logger.log("The media resource indicated by the src attribute was not suitable");break;default:Logger.log("no description")}event.target===this.video_tag||event.target==this.video_src_tag?this.videoInfoObject?(Logger.log("HTML5 ERROR having video!"),this.fatal_error()):Logger.log("HTML5 ERROR ignored --> we have no videoInfoObject"):Logger.log("HTML5 ERROR ignored --> error event is not from video object")},other_event:function(event){this.trigger("player:"+event.type)},waiting:function(){Logger.log("HTML5Player waiting:")},loadstart:function(){Logger.log("HTML5Player loadstart"),this.buffering_started()},durationchange:function(_event){Logger.log("HTML5Player durationchange"),this.duration_update(_event.target.duration)},loadedmetadata:function(){Logger.log("HTML5Player loadedmetadata "+this.video_tag.videoWidth+"/"+this.video_tag.videoHeight)},loadeddata:function(){Logger.log("HTML5Player loadeddata")},progress:function(){this.video_tag.buffered.length>0&&this.buffering_progress(this.video_tag.buffered.end(0))},canplay:function(){Logger.log("HTML5Player canplay"),this.buffering_completed()},canplaythrough:function(){Logger.log("HTML5Player canplaythrough"),this.trigger("player:canplaythrough")},ended:function(){Logger.log("HTML5Player ended"),this.playback_ended()},timeupdate:function(_event){playerInstance.time_update(_event.target.currentTime,_event.target.currentTime)},show:function(){Logger.log("HTML5Player show"),this.video_tag.style.display="block",$(this.video_tag).attr("width","100%"),$(this.video_tag).attr("height","100%"),Logger.log(this.video_tag)},hide:function(){Logger.log("HTML5Player hide"),this.video_tag.style.display="none"},reset:function(){Logger.log("HTML5Player reset"),Player.prototype.reset.call(this),this.removeSource()},removeSource:function(){this.useVideoSourceObject?$("#player_object source").remove():this.video_src_tag&&(this.video_src_tag.src="")},setDisplayArea:function(x,y,width,height){this.el.style.position="fixed",this.el.style.top=y+"px",this.el.style.left=x+"px",this.el.style.width=width+"px",this.el.style.height=height+"px"},seekTo:function(timeInSeconds){this.video_tag.currentTime=timeInSeconds},doPlay:function(){Logger.log("HTML5 playing the video!"),this.video_tag.play()},doPause:function(){Logger.log("HTML5 pausing the video."),this.video_tag.pause()},doStop:function(){Logger.log("HTML5 stopping the video..."),this.video_tag.pause(),this.removeSource()}}),AndroidTVPlayer=HTML5Player.extend({templateID:"framework/player/androidtv",_hasBufferIndicator:!0,resumePlayDelay:.2,initialize:function(_deviceInfo){HTML5Player.prototype.initialize.call(this,_deviceInfo)},playVideo:function(_videoInfoObject,_seekTo){if(_videoInfoObject){if(Player.prototype.playVideo.call(this,_videoInfoObject,_seekTo),this.useVideoSourceObject){var videosrc=document.createElement("source");$(this.video_tag).empty().append(videosrc),this.video_src_tag=videosrc;var self=this;$(videosrc).on("error",function(event){self.error(event)})}else this.video_src_tag=this.video_tag;this.video_src_tag.type=this.videoInfoObject.type,this.video_src_tag.src=this.videoInfoObject.url,this.show(),this.play()}},doPlay:function(){Logger.log("AndroidTV playing the video!"),this.video_tag.play(),window.androidTVWrapper&&window.androidTVWrapper.player_playing()},doPause:function(){Logger.log("AndroidTV pausing the video."),this.video_tag.pause(),window.androidTVWrapper&&window.androidTVWrapper.player_paused()},doStop:function(){Logger.log("AndroidTV stopping the video..."),this.video_tag.pause(),window.androidTVWrapper&&window.androidTVWrapper.player_stopped(),this.removeSource()}}),FireTVPlayer=HTML5Player.extend({templateID:"framework/player/firetv",_hasBufferIndicator:!0,resumePlayDelay:.2,initialize:function(_deviceInfo){HTML5Player.prototype.initialize.call(this,_deviceInfo)},playVideo:function(_videoInfoObject,_seekTo){if(_videoInfoObject){if(Player.prototype.playVideo.call(this,_videoInfoObject,_seekTo),this.useVideoSourceObject){var videosrc=document.createElement("source");$(this.video_tag).empty().append(videosrc),this.video_src_tag=videosrc;var self=this;$(videosrc).on("error",function(event){self.error(event)})}else this.video_src_tag=this.video_tag;this.video_src_tag.type=this.videoInfoObject.type,this.video_src_tag.src=this.videoInfoObject.url,this.show(),this.play()}},doPlay:function(){Logger.log("FireTV playing the video!"),this.video_tag.play(),window.fireTV&&window.fireTV.player_playing()},doPause:function(){Logger.log("FireTV pausing the video."),this.video_tag.pause(),window.fireTV&&window.fireTV.player_paused()},doStop:function(){Logger.log("FireTV stopping the video..."),this.video_tag.pause(),window.fireTV&&window.fireTV.player_stopped(),this.removeSource()}}),PhilipsCEhtmlPlayer=CEHTMLPlayer.extend({initialize:function(_deviceInfo){CEHTMLPlayer.prototype.initialize.call(this,_deviceInfo)},reset:function(){Logger.log("PhilipsPlayer reset"),this.doStop(),Player.prototype.setInitialState.call(this),Logger.log("reset done!")},doStop:function(){Logger.log("PhilipsPlayer stopping the video..."),this.stopPlayPostionInterval(),this.video_tag.stop()}}),PhilipsHTML5Player=HTML5Player.extend({initialize:function(_deviceInfo){HTML5Player.prototype.initialize.call(this,_deviceInfo)},reset:function(){Logger.log("PhilipsPlayer reset"),Player.prototype.setInitialState.call(this),this.doStop()},doStop:function(){Logger.log("PhilipsPlayer stopping the video..."),this.video_tag.pause()}}),SamsungPlayer=Player.extend({templateID:"framework/player/samsung",recreate_on_play:!1,pluginAPI:null,initialize:function(_info){Logger.log("SamsungPlayer initialize ..."),Player.prototype.initialize.call(this,_info),this.pluginAPI=new Common.API.Plugin,window.samPlayerInstance=this,this.plugin=document.getElementById("pluginPlayer"),this.plugin.OnCurrentPlayTime="window.samPlayerInstance.onCurrentPlayTime",this.plugin.OnStreamInfoReady="window.samPlayerInstance.onStreamInfoReady",this.plugin.OnRenderingComplete="window.samPlayerInstance.onRenderingComplete",this.plugin.OnBufferingStart="window.samPlayerInstance.onBufferingStart",this.plugin.OnBufferingComplete="window.samPlayerInstance.onBufferingComplete",this.plugin.OnBufferingProgress="window.samPlayerInstance.onBufferingProgress",this.plugin.OnConnectionFailed="window.samPlayerInstance.onError",this.plugin.OnNetworkDisconnected="window.samPlayerInstance.onError",this.plugin.OnStreamNotFound="window.samPlayerInstance.onError",this.plugin.OnRenderError="window.samPlayerInstance.onError",this.plugin.OnAuthenticationFailed="window.samPlayerInstance.onError",this.videoX=0,this.videoY=0,this.videoWidth=1280,this.videoHeight=720},onError:function(){Logger.log("SamsungPlayer error()"),playerInstance.videoInfoObject?this.fatal_error():Logger.log("Samsung ERROR ignored --> we have no videoInfoObject")},onStreamInfoReady:function(){Logger.log("SamsungPlayer onStreamInfoReady()"),Logger.log("SamsungPlayer onStreamInfoReady() w: "+this.plugin.GetVideoWidth()),Logger.log("SamsungPlayer onStreamInfoReady() h: "+this.plugin.GetVideoHeight()),this.plugin.SetDisplayArea(.75*this.videoX,.75*this.videoY,.75*this.videoWidth,.75*this.videoHeight),this.duration_update(this.plugin.GetDuration()/1e3)},onBufferingStart:function(){Logger.log("SamsungPlayer onBufferingStart()"),playerInstance.buffering_started()},onBufferingComplete:function(){Logger.log("SamsungPlayer onBufferingComplete()"),playerInstance.buffering_completed()},onBufferingProgress:function(_progress_in_percent){Logger.log("SamsungPlayer onBufferingProgress(): "+_progress_in_percent)},onRenderingComplete:function(){Logger.log("SamsungPlayer ended()"),this.pluginAPI.setOnScreenSaver&&this.pluginAPI.setOnScreenSaver(),this.playback_ended()},onCurrentPlayTime:function(_time){this.currentTime=_time,this.time_update(Math.floor(_time/1e3),_time)},show:function(){Logger.log("SamsungPlayer show")},hide:function(){Logger.log("SamsungPlayer hide")},playVideo:function(_videoInfoObject,_seekTo){Player.prototype.playVideo.call(this,_videoInfoObject,_seekTo),this.play()},setDisplayArea:function(x,y,width,height){Logger.log(" Neue GR\xd6SSE DES PLAYERS : "+x+"x"+y+" - "+width+"x"+height),this.videoX=x,this.videoY=y,this.videoWidth=width,this.videoHeight=height,this.plugin.SetDisplayArea(.75*x,.75*y,.75*width,.75*height)
},seekTo:function(timeInSeconds){var skipTime=timeInSeconds-this.currentTime/1e3;this.plugin.JumpForward(skipTime)},doPlay:function(){if(Logger.log("Samsung playing the video!"),this.pluginAPI.setOffScreenSaver&&this.pluginAPI.setOffScreenSaver(),this.pluginAPI.setOffIdleEvent&&this.pluginAPI.setOffIdleEvent(),this.previousState instanceof PausingState)this.plugin.Resume();else{var url_suffix="";this.videoInfoObject.type==Player.VIDEO_TYPES.HLS&&(url_suffix+="|COMPONENT=HLS"),this.plugin.Play(this.videoInfoObject.url+url_suffix)}},doPause:function(){Logger.log("Samsung pausing the video."),this.plugin.Pause()},doStop:function(){Logger.log("Samsung stopping the video..."),this.plugin.Stop(),this.plugin.ClearScreen(),this.pluginAPI.setOnScreenSaver&&this.pluginAPI.setOnScreenSaver()},createVideoObject:function(_url,_type){return Logger.warn("createVideoObject is deprecated -> build your own videoInfoObject: {url: ..,type: ..}, for types see: Player.VIDEO_TYPES"),Player.prototype.createVideoObject.call(this,_url,_type)}}),SamsungTizenPlayer=Player.extend({templateID:"framework/player/samsung_tizen",recreate_on_play:!1,initialize:function(_info){Logger.log("SamsungTizenPlayer initialize ..."),Player.prototype.initialize.call(this,_info),this.eventListeners={onbufferingstart:this.onBufferingStart,onbufferingprogress:this.onBufferingProgress,onbufferingcomplete:this.onBufferingComplete,onstreamcompleted:Util.bind(this,this.onRenderingComplete),oncurrentplaytime:Util.bind(this,this.onCurrentPlayTime),oneventcallback:Util.bind(this,this.onEvent),onsubtitlecallback:function(){console.log("Subtitle Changed.")},ondrmcallback:function(drmEvent,drmData){console.log("DRM callback: "+drmEvent+", data: "+drmData)}},this.videoX=0,this.videoY=0,this.videoWidth=1280,this.videoHeight=720},onEvent:function(eventType,eventData){Logger.log("SamsungTizenPlayer onEvent()"),console.log("Event type error : "+eventType+", eventData: "+eventData)},onBufferingStart:function(){Logger.log("SamsungTizenPlayer onBufferingStart()"),playerInstance.buffering_started()},onBufferingComplete:function(){Logger.log("SamsungTizenPlayer onBufferingComplete()"),playerInstance.buffering_completed()},onBufferingProgress:function(_progress_in_percent){Logger.log("SamsungTizenPlayer onBufferingProgress(): "+_progress_in_percent)},onRenderingComplete:function(){Logger.log("SamsungTizenPlayer ended()"),this.playback_ended()},onCurrentPlayTime:function(_time){this.currentTime=_time,this.time_update(Math.floor(_time/1e3),_time)},show:function(){Logger.log("SamsungTizenPlayer show")},hide:function(){Logger.log("SamsungTizenPlayer hide")},playVideo:function(_videoInfoObject,_seekTo){Player.prototype.playVideo.call(this,_videoInfoObject,_seekTo),this.play()},setDisplayArea:function(x,y,width,height){switch(webapis.avplay.getState()){case"PLAYING":return Logger.log(" Neue GR\xd6SSE DES PLAYERS : "+x+"x"+y+" - "+width+"x"+height),this.videoX=x,this.videoY=y,this.videoWidth=width,this.videoHeight=height,webapis.avplay.pause(),webapis.avplay.setDisplayRect(x,y,width,height),webapis.avplay.play(),!0;case"IDLE":case"PAUSED":return Logger.log(" Neue GR\xd6SSE DES PLAYERS : "+x+"x"+y+" - "+width+"x"+height),this.videoX=x,this.videoY=y,this.videoWidth=width,this.videoHeight=height,webapis.avplay.setDisplayRect(x,y,width,height),!0;case"NONE":case"READY":default:return Logger.log("Not allowed to change player size in this player state: "+webapis.avplay.getState()),!1}},seekTo:function(timeInSeconds){var skipTime=1e3*timeInSeconds-this.currentTime;skipTime>0?webapis.avplay.jumpForward(skipTime):webapis.avplay.jumpBackward(-skipTime)},doPlay:function(){Logger.log("Samsung playing the video!"),this.previousState instanceof PausingState?webapis.avplay.play():(webapis.avplay.open(this.videoInfoObject.url),webapis.avplay.setListener(this.eventListeners),webapis.avplay.prepare(),webapis.avplay.play(),this.duration_update(webapis.avplay.getDuration()/1e3))},doPause:function(){Logger.log("Samsung pausing the video."),webapis.avplay.pause()},doStop:function(){Logger.log("Samsung stopping the video..."),webapis.avplay.stop()},createVideoObject:function(_url,_type){return Logger.warn("createVideoObject is deprecated -> build your own videoInfoObject: {url: ..,type: ..}, for types see: Player.VIDEO_TYPES"),Player.prototype.createVideoObject.call(this,_url,_type)}}),RCEvent=klass({name:"",evObj:null,handled:!1,initialize:function(_name,_evObj){this.name=_name,this.evObj=_evObj},setHandled:function(){this.handled=!0}}),BrowserKeyValue={DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_SEMICOLON:59,DOM_VK_EQUALS:61,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_COMMA:188,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224},TVKeyValue={KEY_RETURN:0,KEY_ENTER:13,KEY_UP:38,KEY_DOWN:40,KEY_LEFT:37,KEY_RIGHT:39,KEY_PAUSE:74,KEY_PLAY:71,KEY_STOP:413,KEY_1:101,KEY_2:98,KEY_3:6,KEY_4:8,KEY_5:9,KEY_6:10,KEY_7:12,KEY_8:13,KEY_9:14,KEY_0:17,KEY_EMPTY:0,KEY_PANEL_CH_UP:105,KEY_PANEL_CH_DOWN:106,KEY_PANEL_VOL_UP:203,KEY_PANEL_VOL_DOWN:204,KEY_PANEL_ENTER:309,KEY_PANEL_SOURCE:612,KEY_PANEL_MENU:613,KEY_PANEL_POWER:614,KEY_POWER:76,KEY_TV:77,KEY_VOL_UP:7,KEY_VOL_DOWN:11,KEY_CH_UP:68,KEY_CH_DOWN:65,KEY_BLUE:406,KEY_EXIT:45},TVKeyValuePhilips={KEY_BACK_SPACE:"undefined"!=typeof VK_BACK?VK_BACK:8,KEY_ENTER:"undefined"!=typeof VK_ENTER?VK_ENTER:13,KEY_UP:"undefined"!=typeof VK_UP?VK_UP:130,KEY_DOWN:"undefined"!=typeof VK_DOWN?VK_DOWN:131,KEY_LEFT:"undefined"!=typeof VK_LEFT?VK_LEFT:132,KEY_RIGHT:"undefined"!=typeof VK_RIGHT?VK_RIGHT:133,KEY_PAUSE:"undefined"!=typeof VK_PAUSE?VK_PAUSE:19,KEY_PLAY:"undefined"!=typeof VK_PLAY?VK_PLAY:415,KEY_STOP:"undefined"!=typeof VK_STOP?VK_STOP:413,KEY_FF:"undefined"!=typeof VK_FAST_FWD?VK_FAST_FWD:408,KEY_RW:"undefined"!=typeof VK_REWIND?VK_REWIND:412,KEY_NEXT:"undefined"!=typeof VK_NEXT?VK_NEXT:34,KEY_PREV:"undefined"!=typeof VK_PREV?VK_PREV:33,KEY_POWER:"undefined"!=typeof VK_POWER?VK_POWER:76,KEY_VOL_UP:"undefined"!=typeof VK_VOLUME_UP?VK_VOLUME_UP:7,KEY_VOL_DOWN:"undefined"!=typeof VK_VOLUME_DOWN?VK_VOLUME_DOWN:11,KEY_CH_UP:"undefined"!=typeof VK_CHANNEL_UP?VK_CHANNEL_UP:68,KEY_CH_DOWN:"undefined"!=typeof VK_CHANNEL_DOWN?VK_CHANNEL_DOWN:65,KEY_RED:"undefined"!=typeof VK_RED?VK_RED:403,KEY_GREEN:"undefined"!=typeof VK_GREEN?VK_GREEN:404,KEY_BLUE:"undefined"!=typeof VK_BLUE?VK_BLUE:406,KEY_YELLOW:"undefined"!=typeof VK_YELLOW?VK_YELLOW:502},TVKeyValueGoogleTV={KEY_BACK_SPACE:8,KEY_BACK:8,KEY_ENTER:13,KEY_UP:38,KEY_DOWN:40,KEY_LEFT:37,KEY_RIGHT:39,KEY_PLAY_PAUSE:179,KEY_STOP:178,KEY_EMPTY:0,KEY_PANEL_CH_UP:105,KEY_PANEL_CH_DOWN:106,KEY_PANEL_VOL_UP:203,KEY_PANEL_VOL_DOWN:204,KEY_PANEL_ENTER:309,KEY_PANEL_SOURCE:612,KEY_PANEL_MENU:613,KEY_PANEL_POWER:614,KEY_POWER:76,KEY_TV:77,KEY_VOL_UP:7,KEY_VOL_DOWN:11,KEY_CH_UP:68,KEY_CH_DOWN:65,KEY_FF:228,KEY_RW:227,KEY_EXIT:45,KEY_0:"undefined"!=typeof VK_0?VK_0:null},TVKeyValueSonyCEB={KEY_BACK_SPACE:"undefined"!=typeof VK_BACK_SPACE?VK_BACK_SPACE:8,KEY_BACK:"undefined"!=typeof VK_BACK_SPACE?VK_BACK_SPACE:8,KEY_ENTER:"undefined"!=typeof VK_ENTER?VK_ENTER:null,KEY_UP:"undefined"!=typeof VK_UP?VK_UP:null,KEY_DOWN:"undefined"!=typeof VK_DOWN?VK_DOWN:null,KEY_LEFT:"undefined"!=typeof VK_LEFT?VK_LEFT:null,KEY_RIGHT:"undefined"!=typeof VK_RIGHT?VK_RIGHT:null,KEY_PAUSE:"undefined"!=typeof VK_PAUSE?VK_PAUSE:null,KEY_PLAY:"undefined"!=typeof VK_PLAY?VK_PLAY:null,KEY_STOP:"undefined"!=typeof VK_STOP?VK_STOP:null,KEY_FF:"undefined"!=typeof VK_FAST_FWD?VK_FAST_FWD:null,KEY_RW:"undefined"!=typeof VK_REWIND?VK_REWIND:null,KEY_NEXT:"undefined"!=typeof VK_TRACK_NEXT?VK_TRACK_NEXT:null,KEY_PREV:"undefined"!=typeof VK_TRACK_PREV?VK_TRACK_PREV:null,KEY_EXIT:"undefined"!=typeof VK_EXIT?VK_EXIT:null,KEY_0:"undefined"!=typeof VK_0?VK_0:null,KEY_RED:"undefined"!=typeof VK_RED?VK_RED:null,KEY_GREEN:"undefined"!=typeof VK_GREEN?VK_GREEN:null,KEY_BLUE:"undefined"!=typeof VK_BLUE?VK_BLUE:null,KEY_YELLOW:"undefined"!=typeof VK_YELLOW?VK_YELLOW:null},TVKeyValuePanasonic={KEY_RETURN:8,KEY_ENTER:13,KEY_UP:38,KEY_DOWN:40,KEY_LEFT:37,KEY_RIGHT:39,KEY_EMPTY:0,KEY_EXIT:null,KEY_1:"undefined"!=typeof VK_1?VK_1:null,KEY_2:"undefined"!=typeof VK_2?VK_2:null,KEY_3:"undefined"!=typeof VK_3?VK_3:null,KEY_4:"undefined"!=typeof VK_4?VK_4:null,KEY_5:"undefined"!=typeof VK_5?VK_5:null,KEY_6:"undefined"!=typeof VK_6?VK_6:null,KEY_7:"undefined"!=typeof VK_7?VK_7:null,KEY_8:"undefined"!=typeof VK_8?VK_8:null,KEY_9:"undefined"!=typeof VK_9?VK_9:null,KEY_0:"undefined"!=typeof VK_0?VK_0:null,KEY_PLAY:"undefined"!=typeof VK_PLAY?VK_PLAY:null,KEY_PAUSE:"undefined"!=typeof VK_PAUSE?VK_PAUSE:null,KEY_STOP:"undefined"!=typeof VK_STOP?VK_STOP:null,KEY_FF:"undefined"!=typeof VK_FAST_FWD?VK_FAST_FWD:null,KEY_RW:"undefined"!=typeof VK_REWIND?VK_REWIND:null,KEY_NEXT:"undefined"!=typeof VK_NEXT?VK_NEXT:null,KEY_PREV:"undefined"!=typeof VK_PREV?VK_PREV:null,KEY_RED:"undefined"!=typeof VK_RED?VK_RED:null,KEY_GREEN:"undefined"!=typeof VK_GREEN?VK_GREEN:null,KEY_BLUE:"undefined"!=typeof VK_BLUE?VK_BLUE:null,KEY_YELLOW:"undefined"!=typeof VK_YELLOW?VK_YELLOW:null},TVKeyValueToshiba={KEY_EXIT:461},TVKeyValueFireTV={KEY_ENTER:13,KEY_UP:38,KEY_DOWN:40,KEY_LEFT:37,KEY_RIGHT:39,KEY_BACK:4,KEY_PLAY_PAUSE:85,KEY_FF:90,KEY_RW:89,KEY_MENU:82},TVKeyValueAndroidTV={KEY_ENTER:13,KEY_UP:38,KEY_DOWN:40,KEY_LEFT:37,KEY_RIGHT:39,KEY_BACK:4,KEY_PLAY_PAUSE:85,KEY_FF:90,KEY_RW:89,KEY_MENU:82},TVKeyValueOppo={KEY_BACK:461,KEY_OK:13,KEY_UP:38,KEY_DOWN:40,KEY_LEFT:37,KEY_RIGHT:39,KEY_PLAY:71,KEY_PAUSE:74,KEY_STOP:413,KEY_FF:228,KEY_RW:227,KEY_NEXT:65,KEY_PREV:68,KEY_BLUE:406},TVKeyValueSamsungTizen={KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_OK:13,KEY_BACK:10009,KEY_PLAY:415,KEY_PAUSE:19,KEY_STOP:413,KEY_RW:412,KEY_FF:417},KeyHandler=klass({tvKey:TVKeyValue,isBlocked:!1,useKeyDownEvents:!0,useKeyPressedEvents:!0,initialize:function(){_.extend(this,Backbone.Events),this.mapKeys("undefined"!=typeof KeyEvent?KeyEvent:BrowserKeyValue),this.useKeyDownEvents&&window.addEventListener("keydown",Util.bind(this,this.receiveKeyDown),!1),this.useKeyPressedEvents&&window.addEventListener("keypress",Util.bind(this,this.receiveKeyPress),!1)},mapKeys:function(_keySet){this.tvKey={};var keyName="";for(key in _keySet)keyName=key.match(/^VK_(.+)/g)?key.replace(/^VK_(.+)/g,"$1"):key.match(/^KEY_(.+)/g)?key.replace(/^KEY_(.+)/g,"$1"):key.match(/^DOM_VK_(.+)/g)?key.replace(/^DOM_VK_(.+)/g,"$1"):key,"RETURN"==keyName?(Logger.log("special found on: "+keyName+" is now: OK"),keyName="OK"):"BACK_SPACE"==keyName?(Logger.log("special found on: "+keyName+" is now: BACK"),keyName="BACK"):"ENTER"==keyName?(Logger.log("special found on: "+keyName+" is now: OK"),keyName="OK"):"REWIND_"==keyName?(Logger.log("special found on: "+keyName+" is now: PREV"),keyName="PREV"):"FF_"==keyName&&(Logger.log("special found on: "+keyName+" is now: NEXT"),keyName="NEXT"),this.tvKey[_keySet[key]]=keyName},receiveKeyDown:function(ev){var key=ev.keyCode;Logger.log("KeyHandler.receiveKeyDown: "+this.tvKey[key]+" ("+key+")"),this.trigger("KeyDown",new RCEvent(this.tvKey[key],ev))},receiveKeyPress:function(ev){var key=ev.keyCode;Logger.log("KeyHandler.receiveKeyPress: "+this.tvKey[key]+" ("+key+")"),this.trigger("KeyPress",new RCEvent(this.tvKey[key],ev))},block:function(){this.isBlocked=!0},unblock:function(){this.isBlocked=!1}}),CEhtmlKeyHandler=KeyHandler.extend({initialize:function(){this.supr()},mapKeys:function(_keySet){this.tvKey={};var keyName="";for(key in _keySet)keyName=key.match(/^VK_(.+)/g)?key.replace(/^VK_(.+)/g,"$1"):key.match(/^KEY_(.+)/g)?key.replace(/^KEY_(.+)/g,"$1"):key.match(/^DOM_VK_(.+)/g)?key.replace(/^DOM_VK_(.+)/g,"$1"):key,"ENTER"==keyName?(Logger.log("special found on: "+keyName+" is now: OK"),keyName="OK"):"REWIND_"==keyName?(Logger.log("special found on: "+keyName+" is now: PREV"),keyName="PREV"):"FF_"==keyName?(Logger.log("special found on: "+keyName+" is now: NEXT"),keyName="NEXT"):"FAST_FWD"==keyName?(Logger.log("special found on: "+keyName+" is now: FF"),keyName="FF"):"REWIND"==keyName&&(Logger.log("special found on: "+keyName+" is now: RW"),keyName="RW"),this.tvKey[_keySet[key]]=keyName}}),HTMLKeyHandler=KeyHandler.extend({pointer_timeout_id:null,pointer_last_position_x:null,pointer_last_position_y:null,pointer_on:!1,pointer_timeout_time:4e3,block_while_processing_event:!1,initialize:function(){this.useKeyPressedEvents=!1,this.supr(),this.registerPointerEvents()},registerPointerEvents:function(){document.onmousemove=Util.bind(this,this.onMouseMove)},receiveKeyDown:function(ev){this.pointerOff(),this.supr(ev)},receiveKeyPress:function(ev){this.pointerOff(),this.supr(ev)},pointerOn:function(){this.pointer_on=!0,this.trigger("PointerChangeState","on"),Logger.log("KeyHandler. pointer on ")},pointerOff:function(){this.pointer_on&&(this.pointer_on=!1,this.trigger("PointerChangeState","off"),Logger.log("KeyHandler. pointer off"))},onMouseMove:function(event){if(!this.block_while_processing_event){if(this.block_while_processing_event=!0,"undefined"!=typeof event.pageX&&this.pointer_last_position_x!=event.pageX||"undefined"!=typeof event.pageY&&this.pointer_last_position_y!=event.pageY)if(this.pointer_last_position_x=event.pageX,this.pointer_last_position_y=event.pageY,this.pointer_on){var that=this;null!=this.pointer_timeout_id&&(clearTimeout(this.pointer_timeout_id),this.pointer_timeout_id=null),this.pointer_timeout_id=setTimeout(function(){that.pointerOff()},this.pointer_timeout_time)}else this.pointerOn();this.block_while_processing_event=!1}}}),GoogleTVKeyHandler=HTMLKeyHandler.extend({initialize:function(){this.mapKeys(TVKeyValueGoogleTV),this.supr()}}),LGKeyHandler=CEhtmlKeyHandler.extend({pointer_on:!1,pointer_last_position_x:null,pointer_last_position_y:null,block_while_processing_event:!1,initialize:function(){this.supr(),this.registerPointerEvents()},registerPointerEvents:function(){window.onmouseon=Util.bind(this,function(){this.pointer_on=!0,this.trigger("PointerChangeState","on")}),window.onmouseoff=Util.bind(this,function(){this.pointer_on=!1,this.trigger("PointerChangeState","off")}),document.onmousemove=Util.bind(this,this.onMouseMove)},onMouseMove:function(event){this.block_while_processing_event||(this.block_while_processing_event=!0,("undefined"!=typeof event.pageX&&this.pointer_last_position_x!=event.pageX||"undefined"!=typeof event.pageY&&this.pointer_last_position_y!=event.pageY)&&(this.pointer_last_position_x=event.pageX,this.pointer_last_position_y=event.pageY,this.pointer_on||(this.pointer_on=!0,this.trigger("PointerChangeState","on"))),this.block_while_processing_event=!1)}}),OppoKeyHandler=KeyHandler.extend({initialize:function(){this.supr(),this.mapKeys(TVKeyValueOppo)}}),PanasonicKeyHandler=KeyHandler.extend({initialize:function(){this.supr(),this.mapKeys(TVKeyValuePanasonic)},mapKeys:function(_keySet){this.tvKey={};var keyName="";for(key in _keySet)key.match(/^KEY_(.+)/g)&&(keyName=key.replace(/^KEY_(.+)/g,"$1"),"RETURN"==keyName?(Logger.log("special found on: "+keyName+" is now: BACK"),keyName="BACK"):"ENTER"==keyName&&(Logger.log("special found on: "+keyName+" is now: OK"),keyName="OK")),this.tvKey[_keySet[key]]=keyName}}),PhilipsKeyHandler=KeyHandler.extend({initialize:function(){this.useKeyPressedEvents=!1,this.supr(),this.mapKeys(TVKeyValuePhilips),this.registerPointerEvents()},registerPointerEvents:function(){window.onmouseon=Util.bind(this,function(){this.trigger("PointerChangeState","on")}),window.onmouseoff=Util.bind(this,function(){this.trigger("PointerChangeState","off")})}}),SamsungKeyHandler=HTMLKeyHandler.extend({initialize:function(){this.supr(),this.mapKeys(new Common.API.TVKeyValue)},mapKeys:function(_keySet){this.tvKey={};var keyName="";for(var key in _keySet)key.match(/^KEY_(.+)/g)&&(keyName=key.replace(/^KEY_(.+)/g,"$1"),"RETURN"==keyName?(Logger.log("special found on: "+keyName+" is now: BACK"),keyName="BACK"):"ENTER"==keyName?(Logger.log("special found on: "+keyName+" is now: OK"),keyName="OK"):"REWIND_"==keyName?(Logger.log("special found on: "+keyName+" is now: PREV"),keyName="PREV"):"FF_"==keyName&&(Logger.log("special found on: "+keyName+" is now: NEXT"),keyName="NEXT")),this.tvKey[_keySet[key]]=keyName},receiveKeyDown:function(ev){this.pointerOff();var key=ev.keyCode;Logger.log("SamsungKeyHandler.receiveKeyDown: "+this.tvKey[key]+" ("+key+")"),1057!=key&&("EXIT"==this.tvKey[key]?this.trigger("ExitKey",new RCEvent(this.tvKey[key],ev)):this.trigger("KeyDown",new RCEvent(this.tvKey[key],ev)))}}),SamsungTizenKeyHandler=HTMLKeyHandler.extend({initialize:function(){tizen.tvinputdevice.registerKey("MediaPlay"),tizen.tvinputdevice.registerKey("MediaStop"),tizen.tvinputdevice.registerKey("MediaPause"),tizen.tvinputdevice.registerKey("MediaPlayPause"),tizen.tvinputdevice.registerKey("MediaRewind"),tizen.tvinputdevice.registerKey("MediaFastForward"),this.supr(),this.mapKeys(TVKeyValueSamsungTizen)},mapKeys:function(_keySet){this.tvKey={};var keyName="";for(var key in _keySet)key.match(/^KEY_(.+)/g)&&(keyName=key.replace(/^KEY_(.+)/g,"$1")),this.tvKey[_keySet[key]]=keyName},receiveKeyDown:function(ev){this.pointerOff();var key=ev.keyCode;console.log("SamsungTizenKeyHandler.receiveKeyDown: "+this.tvKey[key]+" ("+key+")"),this.trigger("KeyDown",new RCEvent(this.tvKey[key],ev))}}),SonyCEBKeyHandler=KeyHandler.extend({initialize:function(){this.supr(),this.mapKeys(TVKeyValueSonyCEB)}}),ToshibaKeyHandler=CEhtmlKeyHandler.extend({initialize:function(){this.supr(),this.tvKey[461]="BACK"},mapKeys:function(_keySet){this.tvKey={};var keyName="";for(key in _keySet)keyName=key.match(/^VK_(.+)/g)?key.replace(/^VK_(.+)/g,"$1"):key.match(/^KEY_(.+)/g)?key.replace(/^KEY_(.+)/g,"$1"):key.match(/^DOM_VK_(.+)/g)?key.replace(/^DOM_VK_(.+)/g,"$1"):key,"RETURN"==keyName?(Logger.log("special found on: "+keyName+" is now: OK"),keyName="OK"):"BACK_SPACE"==keyName?(Logger.log("special found on: "+keyName+" is now: BACK"),keyName="BACK"):"ENTER"==keyName?(Logger.log("special found on: "+keyName+" is now: OK"),keyName="OK"):"FAST_FWD"==keyName?(Logger.log("special found on: "+keyName+" is now: FF"),keyName="FF"):"REWIND"==keyName&&(Logger.log("special found on: "+keyName+" is now: RW"),keyName="RW"),this.tvKey[_keySet[key]]=keyName}}),WdKeyHandler=HTMLKeyHandler.extend({initialize:function(info){this.supr(),info.userAgent.match(/wdsimplebrowser/i)?(this.tvKey[127]="PLAY",this.tvKey[128]="PAUSE",this.tvKey[129]="STOP",this.tvKey[131]="RW",this.tvKey[130]="FF",this.tvKey[27]="BACK",this.tvKey[123]="EXIT"):(this.tvKey[415]="PLAY",this.tvKey[19]="PAUSE",this.tvKey[413]="STOP",this.tvKey[412]="RW",this.tvKey[417]="FF",this.tvKey[27]="BACK",this.tvKey[123]="EXIT")}}),AndroidTVKeyHandler=HTMLKeyHandler.extend({initialize:function(){this.supr(),this.mapKeys(TVKeyValueAndroidTV),window.androidTVWrapper&&(window.androidTVWrapper.simulateKeyDownEvent=this.simulateKeyDownEvent)},simulateKeyDownEvent:function(keyCode){try{this.receiveKeyDown({keyCode:keyCode})}catch(e){Logger.error("ERROR: simulateKeyDownEvent keyCode: ")}}}),FireTVKeyHandler=HTMLKeyHandler.extend({initialize:function(){this.supr(),this.mapKeys(TVKeyValueFireTV),window.fireTV&&(window.fireTV.simulateKeyDownEvent=this.simulateKeyDownEvent)},simulateKeyDownEvent:function(keyCode){try{this.receiveKeyDown({keyCode:keyCode})}catch(e){Logger.error("ERROR: simulateKeyDownEvent keyCode: ")}}}),IO=klass({load:function(){},save:function(){},erase:function(){},get:function(key){var result=null,k=key.toLowerCase();return"undefined"!=typeof this.data[k]&&(result=this.data[k]),result},set:function(key,value,suc,err){this.data[key.toLowerCase()]=value,this.save(suc,err)},setObj:function(obj,suc,err){for(var key in obj)this.data[key.toLowerCase()]=obj[key];this.save(suc,err)},del:function(key,suc,err){var result=!1;if(!key)return result;var k=key.toLowerCase();"undefined"!=typeof this.data[k]&&delete this.data[k],this.save(suc,err)},has:function(key){var result=!1;if(!key)return result;var k=key.toLowerCase();return"undefined"!=typeof this.data[k]&&(result=!0),result}}),CookieIO=IO.extend({initialize:function(o){o=o||{},this.domain=o.domain||"",this.expires=o.expires||new Date(2030,2,19),this.name=o.name||"JSON",this.path=o.path||"/"},load:function(suc,err){var cookie=unescape(document.cookie);if(cookie){cookie=cookie.split(";");for(var i=0,line=null,l=cookie.length;l>i;i++)if(line=cookie[i],line.indexOf(this.name+"=")>-1){line=line.split("=");try{this.data=JSON.parse(line[1]),suc&&suc()}catch(e){err&&err(e)}return}this.data={},suc&&suc()}else this.data={},suc&&suc()},save:function(suc){document.cookie=this.name+"="+escape(JSON.stringify(this.data))+"; expires="+this.expires.toUTCString()+(this.domain?"; domain="+this.domain:"")+"; path="+this.path,suc&&suc()},erase:function(suc){document.cookie="name=; expires=Thu, 01-Jan-1970 00:00:01 GMT"+(this.domain?"; domain="+this.domain:"")+"; path="+this.path,suc&&suc()}}),SamsungIO=IO.extend({initialize:function(o){o=o||{},this.fileName=curWidget.id+"/"+(o.fileName||"app")+".session"},load:function(suc,err){var file=null;try{if(!this.fileSystem&&(this.fileSystem=new FileSystem),file=this.fileSystem.openCommonFile(this.fileName,"r")){var str=unescape(file.readLine());str&&(this.data=JSON.parse(str)),this.fileSystem.closeCommonFile(file)}suc&&suc()}catch(e){file&&this.fileSystem.closeCommonFile(file),err&&err(e)}},save:function(suc,err){try{!this.fileSystem&&(this.fileSystem=new FileSystem),this.fileSystem.isValidCommonPath(curWidget.id)||this.fileSystem.createCommonDir(curWidget.id);var file=this.fileSystem.openCommonFile(this.fileName,"w");file&&(file.writeLine(escape(JSON.stringify(this.data))),this.fileSystem.closeCommonFile(file),suc&&suc())}catch(e){file&&this.fileSystem.closeCommonFile(file),err&&err(e)}},erase:function(o,suc){!this.fileSystem&&(this.fileSystem=new FileSystem),this.fileSystem.deleteCommonFile(this.fileName),suc&&suc()}}),SamsungTizenIO=IO.extend({initialize:function(o){o=o||{},this.fileName=(o.fileName||"app")+".session"},load:function(suc,err){tizen.filesystem.resolve("wgt-private",Util.bind(this,function(dir){dir.listFiles(Util.bind(this,function(files){for(var fileFound=!1,i=0;i<files.length;i++)if(files[i].name==this.fileName){fileFound=!0;break}if(fileFound)console.log("File already exists!"),this.read(suc,err);else try{dir.createFile(this.fileName),console.log("File created!"),this.data={},this.save(suc,err)}catch(e){err&&err(e)}}))}))},read:function(suc,err){tizen.filesystem.resolve("wgt-private/"+this.fileName,Util.bind(this,function(file){try{file.openStream("r",Util.bind(this,function(stream){try{var str=stream.read(stream.bytesAvailable);this.data=JSON.parse(unescape(str)),stream.close(),suc&&suc()}catch(e){stream.close(),err&&err(e)}}))}catch(e){err&&err(e)}}))},save:function(suc,err){console.log("Tizen saving..."),tizen.filesystem.resolve("wgt-private/"+this.fileName,Util.bind(this,function(file){try{file.openStream("w",Util.bind(this,function(stream){try{stream.write(escape(JSON.stringify(this.data))),stream.close(),suc&&suc()}catch(e){stream.close(),err&&err(e)}}))}catch(e){err&&err(e)}}))},erase:function(suc,err){console.log("Tizen deleting..."),tizen.filesystem.resolve("wgt-private",Util.bind(this,function(dir){dir.listFiles(Util.bind(this,function(files){for(var i=0;i<files.length;i++)if(files[i].name==this.fileName)return void dir.deleteFile(files[i].fullPath,suc,err);err&&err()}))}))}}),AndroidTVIO=CookieIO.extend({save:function(suc,err){this.supr(function(){window.androidTVWrapper&&window.androidTVWrapper.syncCookies&&window.androidTVWrapper.syncCookies(),suc&&suc()},err)}}),FireTVIO=CookieIO.extend({save:function(suc,err){this.supr(function(){window.fireTV&&window.fireTV.syncCookies&&window.fireTV.syncCookies(),suc&&suc()},err)}}),DeviceFactory=klass({info:{},initialize:function(){},checkDeviceByHash:function(_stringToMatch){return Util.match(this.info.hash,_stringToMatch,!0)},checkDeviceByUserAgent:function(_stringToMatch,_caseInsensitive,_useRegex){return Util.match(this.info.userAgent,_stringToMatch,_caseInsensitive,_useRegex)},checkDeviceByHashAndUserAgent:function(_stringToMatch,_caseInsensitive){return this.checkDeviceByHash(_stringToMatch)&&this.checkDeviceByUserAgent(_stringToMatch,_caseInsensitive)},onDeviceCreation:function(_device){return _device},createDevice:function(){}}),DefaultFeatures=klass({hasFeature:function(){return!1}}),SamsungFeatures=DefaultFeatures.extend({initialize:function(device){this.device=device},hasFeature:function(feature){return"screen_saver"==feature||"pointer_support"==feature},enableScreenSaver:function(enabled){enabled?this.device.pluginAPI.setOnScreenSaver():this.device.pluginAPI.setOffScreenSaver()}}),SamsungTizenFeatures=DefaultFeatures.extend({initialize:function(device){this.device=device},hasFeature:function(feature){return"pointer_support"==feature}}),PointerFeatures=DefaultFeatures.extend({initialize:function(device){this.device=device},hasFeature:function(feature){return"pointer_support"==feature}}),Device=klass({info:{},isConnected:!0,preloadedImages:{},player:null,keyHandler:null,cssAnimation:!1,cssTransition:!1,initialize:function(_info){_.extend(this,Backbone.Events),this.info=_info,this.info.vendor=_info.vendor||"",this.info.technology=_info.technology||"",this.info.type=_info.type||"",this.info.width=_info.width||1280,this.info.height=_info.height||720,this.info.confirmAppExit=_info.confirmAppExit||!1,this.info.version=_info.version||"",this.addCSSclasses(),this.cssAnimation=this.determineCSSCapabilities("animation"),this.cssTransition=this.determineCSSCapabilities("transition")},html:function(eObj,h){Util.html(eObj[0],h)},append:function(eObj,h){Util.append(eObj[0],h,!1)},addCSSclasses:function(){""!==this.info.vendor&&$("#WidgetBody").addClass(this.info.vendor),""!==this.info.technology&&$("#WidgetBody").addClass(this.info.technology)},createKeyHandler:function(){return this.keyHandler=new KeyHandler,this.keyHandler},createPlayer:function(){return this.player=new Player(this.info),this.player},exit:function(){Logger.log("Device.exit")},ready:function(){Logger.log("Device.ready")},initLogger:function(){Logger.setup(!1,!0,!1)},logger:function(){return Logger},getIO:function(o){return new CookieIO(o)},startCheckingConnectivity:function(){Logger.log("Device.startCheckingConnectivity")},preloadImages:function(_aURL){Util.preloadImages(_aURL,this.preloadedImages)},getFeatures:function(){return new DefaultFeatures},getDeviceDetails:function(){return(""===this.info.type?NOT_AVAILABLE:this.info.type)+"_"+(""===this.info.version?NOT_AVAILABLE:this.info.version)},getDeviceFirmwareDetails:function(){return NOT_AVAILABLE},getLanguage:function(_fallback){Logger.log("Device.getLanguage");var language=null;try{language=navigator.language?navigator.language.split("-")[0]:language}catch(e){}return language||(language=_fallback?_fallback:language),Logger.log("Device.getLanguage: "+language),language},determineCSSCapabilities:function(featurename){var feature=!1,result=!1,domPrefixes="Webkit Moz ms O Khtml".split(" "),elm=document.createElement("div"),featurenameCapital=null;if(featurename=featurename.toLowerCase(),elm.style[featurename]&&(feature=!0),feature===!1){featurenameCapital=featurename.charAt(0).toUpperCase()+featurename.substr(1);for(var i=0;i<domPrefixes.length;i++)if(void 0!==elm.style[domPrefixes[i]+featurenameCapital]){feature=!0,pfx=domPrefixes[i],result={prefix:pfx.toLowerCase(),feature:pfx.toLowerCase()+featurenameCapital,keyframeprefix:"-"+pfx.toLowerCase()+"-"};break}}return result},canAnimateCSS:function(){return this.cssAnimation!==!1},canTransitionCSS:function(){return this.cssTransition!==!1},checkByHash:function(_stringToMatch){return Util.match(this.hash,_stringToMatch,!0)},checkByUserAgent:function(_stringToMatch,_caseInsensitive,_useRegex){return Util.match(this.info.userAgent,_stringToMatch,_caseInsensitive,_useRegex)},checkByHashAndUserAgent:function(_stringToMatch,_caseInsensitive){return this.checkDeviceByHash(_stringToMatch)&&this.checkDeviceByUserAgent(_stringToMatch,_caseInsensitive)}}),CEhtmlDevice=Device.extend({initialize:function(_info){_info.technology=TECHNOLOGY.CEHTML,this.supr(_info)},createKeyHandler:function(){return this.keyHandler=new CEhtmlKeyHandler,this.keyHandler},createPlayer:function(){return this.player=new CEHTMLPlayer(this.info),this.player},append:function(eObj,h){Util.append(eObj[0],h,!0)},initLogger:function(){Logger.setup(!0,!1,!1),Logger.show()}}),Html5Device=Device.extend({initialize:function(_info){_info.technology=TECHNOLOGY.HTML5,this.supr(_info)},createPlayer:function(){return this.player=new HTML5Player(this.info),this.player},initLogger:function(){Logger.setup(!0,!1,!1),Logger.show()},createKeyHandler:function(){return this.keyHandler=new HTMLKeyHandler,this.keyHandler},exit:function(){window.history.go(-2)}}),DevelopmentDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.useVideoSourceObject=!0,this.checkDeviceByUserAgent("Chrome",!1)?this.info.type=DEVICE_TYPE.PC_CHROME:this.checkDeviceByUserAgent("Firefox",!1)?this.info.type=DEVICE_TYPE.PC_FIREFOX:this.checkDeviceByUserAgent("Opera",!1)?this.info.type=DEVICE_TYPE.PC_OPERA:this.checkDeviceByUserAgent("Safari",!1)&&(this.info.type=DEVICE_TYPE.PC_SAFARI)},createDevice:function(){return this.setupDevelopment(),this.onDeviceCreation(new Html5Device(this.info))},setupDevelopment:function(){Html5Device=Html5Device.extend({initialize:function(_info){this.supr(_info),this.initLogger()},initLogger:function(){Logger.setup(!1,!0,!1)},getFeatures:function(){return new PointerFeatures(this)}})}}),AndroidTVDeviceFactory=DeviceFactory.extend({initialize:function(_info){if(this.info=_info,this.info.vendor=VENDOR.GOOGLE,this.info.platform=PLATFORM.ANDROIDTV,this.info.useVideoSourceObject=!1,this.checkDeviceByHash("androidtv-")){var suffix=this.info.hash.replace(/^.*androidtv\-(.+)/g,"$1");suffix&&(suffix=suffix.toLowerCase(),_.every(VENDOR,function(name){return name=name.toLowerCase(),name!==suffix?!0:void(this.info.vendor=name)},this))}},createDevice:function(){return this.setupAndroidTV(),this.onDeviceCreation(new Html5Device(this.info))},setupAndroidTV:function(){Html5Device=Html5Device.extend({initialize:function(_info){this.supr(_info),this.info.hasBadResolution=!1},createKeyHandler:function(){return this.keyHandler=new AndroidTVKeyHandler,this.keyHandler},zoom:function(){var sw=screen.width,sh=screen.height,sRatio=sw/sh,wRatio=sw/this.info.width,hRatio=sh/this.info.height,zoomratio=wRatio>hRatio?wRatio:hRatio;
(1.7>sRatio||sRatio>1.8)&&(this.info.hasBadResolution=!0),$("body").css("zoom",zoomratio)},createPlayer:function(){return this.player=new AndroidTVPlayer(this.info),this.player},getIO:function(o){return new AndroidTVIO(o)},getWrapperVersion:function(){var androidTVWrapperVersion=null;if(window.androidTVWrapper&&window.androidTVWrapper.getWrapperVersion){var version=window.androidTVWrapper.getWrapperVersion();""!=version&&(androidTVWrapperVersion=version)}return androidTVWrapperVersion},ready:function(){window.androidTVWrapper&&window.androidTVWrapper.ready()},setNowPlayingMetaData:function(metaData){metaData&&window.androidTVWrapper&&window.androidTVWrapper.setNowPlayingMetaData(JSON.stringify(metaData))},exit:function(){window.history.go(-2),window.androidTVWrapper&&window.androidTVWrapper.exit()}})}}),FireTVDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.AMAZON,this.info.platform=PLATFORM.FIRETV,this.info.useVideoSourceObject=!1},createDevice:function(){return this.setupFireTV(),this.onDeviceCreation(new Html5Device(this.info))},setupFireTV:function(){Html5Device=Html5Device.extend({initialize:function(_info){this.supr(_info),this.info.hasBadResolution=!1},createKeyHandler:function(){return this.keyHandler=new FireTVKeyHandler,this.keyHandler},zoom:function(){var sw=screen.width,sh=screen.height,sRatio=sw/sh,wRatio=sw/this.info.width,hRatio=sh/this.info.height,zoomratio=wRatio>hRatio?wRatio:hRatio;(1.7>sRatio||sRatio>1.8)&&(this.info.hasBadResolution=!0),$("body").css("zoom",zoomratio)},createPlayer:function(){return this.player=new FireTVPlayer(this.info),this.player},getIO:function(o){return new FireTVIO(o)},getWrapperVersion:function(){var fireTVWrapperVersion=null;if(window.fireTV&&window.fireTV.getWrapperVersion){var version=window.fireTV.getWrapperVersion();""!=version&&(fireTVWrapperVersion=version)}return fireTVWrapperVersion},ready:function(){window.fireTV&&window.fireTV.ready()},exit:function(){window.history.go(-2),window.fireTV&&window.fireTV.exit()}})}}),GoogleTVDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.platform=PLATFORM.GOOGLETV,this.info.useVideoSourceObject=!0},createDevice:function(){return this.checkDeviceByUserAgent("GoogleTV",!1)?(this.setupGoogleTV(),this.onDeviceCreation(new Html5Device(this.info))):this.onDeviceCreation(new Device(this.info))},setupGoogleTV:function(){Html5Device=Html5Device.extend({initialize:function(_info){this.supr(_info),this.info.hasBadResolution=!1,this.zoom()},createKeyHandler:function(){return this.keyHandler=new GoogleTVKeyHandler,this.keyHandler},zoom:function(){var sw=screen.width,sh=screen.height,sRatio=sw/sh,wRatio=sw/this.info.width,hRatio=sh/this.info.height,zoomratio=wRatio>hRatio?wRatio:hRatio;(1.7>sRatio||sRatio>1.8)&&(this.info.hasBadResolution=!0),$("body").css("zoom",zoomratio)},getDeviceFirmwareDetails:function(){try{var firmware="",index_firmware=this.info.userAgent.indexOf("GoogleTV/");if(index_firmware>-1)firmware=this.info.userAgent.substring(index_firmware+9);else{var res=this.userAgent.match(/GoogleTV\s([.0-9]*);\s(.*)\sBuild\/([.0-9]*)\)/);4==res.length&&(firmware+=res[1],firmware+="_"+res[2],firmware+="/"+res[3])}return Logger.log("firmware GoogleTV: "+firmware),firmware}catch(e){return Logger.log("ERROR GoogleTV Firmware: "+e),""}},getFeatures:function(){return new PointerFeatures(this)}})}}),LGDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.LG},createDevice:function(){switch(this.checkDeviceByUserAgent("Web0S",!1)?this.info.version="webos":this.checkDeviceByUserAgent("LG NetCast.TV-2011",!1)||this.checkDeviceByUserAgent("LG NetCast.Media-2011",!1)?this.info.version="2.0":this.checkDeviceByUserAgent("LG NetCast.TV-2012",!1)||this.checkDeviceByUserAgent("LG NetCast.Media-2012",!1)?this.info.version="3.0":(this.checkDeviceByUserAgent("LG NetCast.TV-2013",!1)||this.checkDeviceByUserAgent("LG NetCast.Media-2013",!1))&&(this.info.version="4.0"),this.info.version){case"webos":return this.info.type=DEVICE_TYPE.TV,this.setupLGWebOS(),this.onDeviceCreation(new Html5Device(this.info));default:return this.info.type=!this.checkDeviceByUserAgent("LG NetCast.TV",!1)||this.checkDeviceByUserAgent("LG NetCast.TV-2012",!1)&&this.checkDeviceByUserAgent("SP820",!1)?DEVICE_TYPE.BDP:DEVICE_TYPE.TV,this.setupLG(),this.onDeviceCreation(new CEhtmlDevice(this.info))}},setupLG:function(){CEhtmlDevice=CEhtmlDevice.extend({createKeyHandler:function(){return this.keyHandler=new LGKeyHandler,this.keyHandler},exit:function(){window.NetCastBack&&window.NetCastBack()},addDeviceDetailsCSSClasses:function(){var model_year=this.info.userAgent.replace(/^.*LG\sNetCast\.(TV|Media)-(20[1-9][1-9]).*$/g,"$2");$("#WidgetBody").addClass("year"+model_year)},getDeviceDetails:function(){return(""===this.info.type?NOT_AVAILABLE:this.info.type)+"_"+this.info.userAgent.replace(/^.*LG\sNetCast\.(TV|Media)-(20[1-9][1-9]).*$/g,"$2")},getDeviceFirmwareDetails:function(){try{var lg_device=document.getElementById("device"),deviceVersion=lg_device.version,swVersion=lg_device.swVersion,modelName=lg_device.modelName,hwVersion=lg_device.hwVersion,deviceInfo=deviceVersion+"<br/>"+hwVersion+"<br/>"+swVersion+"<br/>"+modelName;return Logger.log("firmware LG: "+deviceInfo),swVersion+"_"+modelName}catch(e){return Logger.log("ERROR LG Firmware: "+e),""}},getFeatures:function(){return new PointerFeatures(this)},getLanguage:function(_fallback){Logger.log("LGDevice.getLanguage:");var language=null;try{var lgdevice=document.getElementById("device");lgdevice&&(language=lgdevice.tvLanguage2.split("-")[0])}catch(e){}return language?(Logger.log("LGDevice.getLanguage: "+language),language):this.supr(_fallback)}})},setupLGWebOS:function(){Html5Device=Html5Device.extend({getFeatures:function(){return new PointerFeatures(this)},addDeviceDetailsCSSClasses:function(){$("#WidgetBody").addClass("webos")}})}}),PanasonicDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.PANASONIC},createDevice:function(){return this.setupPanasonic(),this.onDeviceCreation(new Html5Device(this.info))},setupPanasonic:function(){Html5Device=Html5Device.extend({initialize:function(_info){this.pingURL=_info.params.pingURL||"",this.supr(_info)},createKeyHandler:function(){return this.keyHandler=new PanasonicKeyHandler,this.keyHandler},ready:function(){Logger.log("PanasonicDevice.ready"),this.startCheckingConnectivity()},setPingURL:function(_url){this.pingURL=_url},exit:function(){window.close()},startCheckingConnectivity:function(){if(""==this.pingURL)Logger.log("WARNING: Please set up ping URL with setPingURL(_url) for connectivity check!");else{var that=this;this._netCableConInterval=setInterval(function(){$.ajax({type:"GET",timeout:5e3,url:that.pingURL+"?"+Math.floor(1e5*Math.random(10)),success:function(){that.isConnected||(that.isConnected=!0,that.trigger("connection:reestablished",that)),result=!0},error:function(){that.isConnected&&(that.isConnected=!1,that.trigger("connection:lost",that)),result=!1},async:!0})},4e3)}}})}}),PhilipsDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.PHILIPS,this.info.useVideoSourceObject=!0,this.detectNetTVVersion(),this.techVersion=this.checkDeviceByHash("-html5")?TECHNOLOGY.HTML5:TECHNOLOGY.CEHTML},createDevice:function(){switch(this.techVersion){case TECHNOLOGY.HTML5:return this.setupPhilipsHtml5(),this.onDeviceCreation(new Html5Device(this.info));case TECHNOLOGY.CEHTML:return this.setupPhilipsCEhtml(),this.onDeviceCreation(new CEhtmlDevice(this.info))}},detectNetTVVersion:function(){this.info.version=this.info.userAgent.replace(/.+NETTV\/(\S+).+/g,"$1")},setupPhilipsCEhtml:function(){CEhtmlDevice=CEhtmlDevice.extend({createKeyHandler:function(){return this.keyHandler=new PhilipsKeyHandler,this.keyHandler},createPlayer:function(){return this.player=new PhilipsCEhtmlPlayer(this.info),this.player},exit:function(){window.history.go(-999)}})},setupPhilipsHtml5:function(){Html5Device=Html5Device.extend({createKeyHandler:function(){return this.keyHandler=new PhilipsKeyHandler,this.keyHandler},createPlayer:function(){return this.player=new PhilipsHTML5Player(this.info),this.player},exit:function(){window.history.go(-999)}})}}),SamsungDeviceFactory=DeviceFactory.extend({initialize:function(_info){Logger.log("SamsungDeviceFactory"),this.info=_info,this.info.technology=TECHNOLOGY.PROP,this.info.vendor=VENDOR.SAMSUNG,/^.*Tizen.*$/.test(this.info.userAgent)?this.info.platform=PLATFORM.TIZEN:this.detectProductType()},createDevice:function(){switch(this.info.platform){case PLATFORM.TIZEN:return this.onDeviceCreation(new SamsungTizenDevice(this.info));default:return this.onDeviceCreation(new SamsungDevice(this.info))}},detectProductType:function(){var productId=this.info.windowLocation.replace(/^.*product=(\d).*$/,"$1");switch(productId){case"0":this.info.type=DEVICE_TYPE.TV;break;case"2":this.info.type=DEVICE_TYPE.BDP}}}),SamsungDevice=Device.extend({widgetAPI:null,pluginAPI:null,tvKey:null,NNaviPlugin:null,NetworkPlugin:null,exitKeyCallback:null,initialize:function(_info){_info.technology=TECHNOLOGY.PROP,Device.prototype.initialize.call(this,_info),this.widgetAPI=new Common.API.Widget,this.pluginAPI=new Common.API.Plugin,this.tvKey=new Common.API.TVKeyValue,this.NetworkPlugin=document.getElementById("pluginObjectNetwork"),window.onShow=Util.bind(this,function(){Logger.log("samsung onshow"),this.NNaviPlugin=document.getElementById("pluginObjectNNavi"),this.NNaviPlugin.SetBannerState(1),this.pluginAPI.unregistKey(this.tvKey.KEY_VOL_UP),this.pluginAPI.unregistKey(this.tvKey.KEY_VOL_DOWN),this.pluginAPI.unregistKey(this.tvKey.KEY_MUTE),this.pluginAPI.setOffScreenSaver&&this.pluginAPI.setOffScreenSaver(),this.pluginAPI.setOffIdleEvent&&this.pluginAPI.setOffIdleEvent(),this.getTVVersion()>=2012&&(this.pluginAPI.unregistKey(this.tvKey.KEY_WLINK),this.pluginAPI.unregistKey(this.tvKey.KEY_CONTENT)),this.addDeviceDetailsCSSClasses()}),this.isEmulator()&&this.initLogger(),window.onunload=Util.bind(this,function(){this.player.doStop()})},initLogger:function(){this.isEmulator()?Logger.setup(!1,!1,!0):(Logger.setup(!0,!1,!1),Logger.show())},addDeviceDetailsCSSClasses:function(){var tv_version=this.getTVVersion();$("#WidgetBody").addClass(2012>tv_version?"maple":"webkit"),$("#WidgetBody").addClass("year"+tv_version)},createKeyHandler:function(){return this.keyHandler=new SamsungKeyHandler,this.keyHandler.on("ExitKey",this.exitOnExitKey,this),this.keyHandler},createPlayer:function(){return this.player=new SamsungPlayer,this.player},exit:function(){Logger.log("SamsungDevice.exit: "),this.widgetAPI.sendReturnEvent()},exitOnExitKey:function(){Logger.log("SamsungDevice.exitOnExitKey: "),"function"==typeof this.exitKeyCallback?this.exitKeyCallback():this.widgetAPI.sendExitEvent()},setExitKeyCallback:function(_cb){Logger.log("SamsungDevice.setExitKeyCallback: "),"function"==typeof _cb&&(this.exitKeyCallback=_cb)},ready:function(){Logger.log("SamsungDevice.ready"),this.widgetAPI.sendReadyEvent(),this.pluginAPI.setOffScreenSaver&&this.pluginAPI.setOffScreenSaver(),this.pluginAPI.setOffIdleEvent&&this.pluginAPI.setOffIdleEvent(),this.startCheckingConnectivity()},getTVVersion:function(){try{var firmware=this.NNaviPlugin.GetFirmware();Logger.log("firmware "+firmware+" "+firmware.substring(10,14));var year_integer=parseInt(firmware.substring(10,14),10);return year_integer}catch(e){return Logger.log("Exception(Firmware Check) : "+e),0}},getFirmwareVersion:function(){try{var firmware=this.NNaviPlugin.GetFirmware();Logger.log("firmware complete: "+firmware);var firmware2=this.NNaviPlugin.GetSystemVersion(PL_NNAVI_SYSTEM_VERSION_LEEUM);Logger.log("firmware LEEUM: "+firmware2);var firmware3=this.NNaviPlugin.GetSystemVersion(PL_NNAVI_SYSTEM_VERSION_COMP);return Logger.log("firmware COMP: "+firmware3),firmware=firmware.substring(15),Logger.log("firmware SamS substring: "+firmware),firmware}catch(e){return Logger.log("ERROR Samsung Firmware: "+e),""}},getAbsolutePath:function(linkString){var Abs_path="",rootPath=window.location.href.substring(0,location.href.lastIndexOf("/")+1);return Abs_path=-1==unescape(window.location.toString()).indexOf("localhost")?-1!=unescape(window.location.toString()).indexOf("file://C")?unescape(rootPath).split("file://")[1].replace("C/","C:/")+linkString:-1!=unescape(window.location.toString()).indexOf("file://c")?unescape(rootPath).split("file://")[1].replace("c/","C:/")+linkString:unescape(rootPath).split("file://")[1]+linkString:-1!=unescape(window.location.toString()).indexOf("C:")?"/"+unescape(rootPath).split("file://localhost/C:\\")[1].replace(/\\/g,"/")+linkString:"/"+unescape(rootPath).split("file://localhost/")[1]+linkString},isEmulator:function(){window.location.href.substring(0,location.href.lastIndexOf("/")+1);return-1==unescape(window.location.toString()).indexOf("localhost")?-1!=unescape(window.location.toString()).indexOf("file://C")||-1!=unescape(window.location.toString()).indexOf("file://c")?!0:!1:-1!=unescape(window.location.toString()).indexOf("C:")?!0:!1},getIO:function(o){return new SamsungIO(o)},startCheckingConnectivity:function(){var that=this;this._netCableConInterval=setInterval(function(){1==that.NetworkPlugin.CheckPhysicalConnection(1)||1==that.NetworkPlugin.CheckPhysicalConnection(0)?that.isConnected||(that.isConnected=!0,that.trigger("connection:reestablished",that)):that.isConnected&&(that.isConnected=!1,that.trigger("connection:lost",that))},4e3)},checkNetwork:function(){var physicalConnection=0,httpStatus=0;return currentInterface=networkPlugin.GetActiveType(),-1===currentInterface?!1:(physicalConnection=networkPlugin.CheckPhysicalConnection(currentInterface),1!==physicalConnection?!1:(httpStatus=networkPlugin.CheckHTTP(currentInterface),1!==httpStatus?!1:!0))},getFeatures:function(){return new SamsungFeatures(this)},getDeviceDetails:function(){return(""===this.info.type?NOT_AVAILABLE:this.info.type)+"_"+this.getTVVersion()},getDeviceFirmwareDetails:function(){var firmware=this.getFirmwareVersion();return""===firmware?NOT_AVAILABLE:firmware},getLanguage:function(_fallback){Logger.log("SamsungDevice.getLanguage");var language=null;try{var str=window.location.search,returnVar=[],results=str.split("&");for(i=0;i<results.length;i++){var result=results[i].split("=");if(returnVar[i]={vars:result[0],values:result[1]},"lang"==result[0]){language=result[1].split("-")[0];break}}}catch(e){}return language?(Logger.log("SamsungDevice.getLanguage: "+language),language):this.supr(_fallback)}}),SamsungTizenDevice=Device.extend({initialize:function(_info){_info.technology=TECHNOLOGY.PROP,Device.prototype.initialize.call(this,_info),this.addDeviceDetailsCSSClasses()},initLogger:function(){Logger.setup(!1,!0,!1)},addDeviceDetailsCSSClasses:function(){$("#WidgetBody").addClass("tizen")},createKeyHandler:function(){return this.keyHandler=new SamsungTizenKeyHandler,this.keyHandler},createPlayer:function(){return this.player=new SamsungTizenPlayer,this.player},exit:function(){Logger.log("SamsungTizenDevice.exit: "),tizen.application.getCurrentApplication().exit()},ready:function(){Logger.log("SamsungTizenDevice.ready")},getIO:function(o){return new SamsungTizenIO(o)},getTVVersion:function(){return 2015},getFeatures:function(){return new SamsungTizenFeatures(this)},getDeviceDetails:function(){return(""===this.info.type?NOT_AVAILABLE:this.info.type)+"_tizen"},getDeviceFirmwareDetails:function(){return NOT_AVAILABLE}}),OperaTVStoreDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.platform=PLATFORM.OPERATVSTORE,this.info.useVideoSourceObject=!0},createDevice:function(){if(this.checkDeviceByUserAgent("SonyCEBrowser",!1))this.info.vendor=VENDOR.SONY;else if(this.checkDeviceByUserAgent("Swisscom",!1))this.info.vendor=VENDOR.SWISSCOM;else if(this.checkDeviceByHash("opera-")){var suffix=this.info.hash.replace(/^.*opera\-(.+)/g,"$1");suffix&&(suffix=suffix.toLowerCase(),_.every(VENDOR,function(name){return name=name.toLowerCase(),name!==suffix?!0:void(this.info.vendor=name)},this))}return this.setupOpera(),this.onDeviceCreation(new Html5Device(this.info))},setupOpera:function(){Html5Device=Html5Device.extend({createKeyHandler:function(){return this.keyHandler=new SonyCEBKeyHandler,this.keyHandler},exit:function(){window.close()}})}}),OppoDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.OPPO,this.info.type=DEVICE_TYPE.BDP},createDevice:function(){return this.setupOppo(),this.onDeviceCreation(new Html5Device(this.info))},setupOppo:function(){Html5Device=Html5Device.extend({createKeyHandler:function(){return this.keyHandler=new OppoKeyHandler,this.keyHandler}})}}),SonyDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.SONY,this.info.useVideoSourceObject=!0},createDevice:function(){if(this.checkDeviceByUserAgent("GoogleTV",!1)){var googleTVFactory=new GoogleTVDeviceFactory(this.info);return this.onDeviceCreation(googleTVFactory.createDevice())}return this.checkDeviceByUserAgent("SonyCEBrowser",!1)?(this.setupCEB(),this.onDeviceCreation(new Html5Device(this.info))):this.onDeviceCreation(new Device(this.info))},setupCEB:function(){Html5Device=Html5Device.extend({createKeyHandler:function(){return this.keyHandler=new SonyCEBKeyHandler,this.keyHandler},exit:function(){window.close()}})}}),TechnisatDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.TECHNISAT},createDevice:function(){return this.setupTechnisat(),this.onDeviceCreation(new CEhtmlDevice(this.info))},setupTechnisat:function(){CEhtmlDevice=CEhtmlDevice.extend({exit:function(){}})}}),ToshibaDevice=Html5Device.extend({initialize:function(_info){this.supr(_info)},createKeyHandler:function(){return this.keyHandler=new ToshibaKeyHandler,this.keyHandler},exit:function(){window.location="Toshiba/toshiba_exit.html"}}),ToshibaDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.TOSHIBA,this.techVersion=this.checkDeviceByHash("-html5")?TECHNOLOGY.HTML5:TECHNOLOGY.CEHTML},createDevice:function(){switch(this.techVersion){case TECHNOLOGY.HTML5:return this.setupToshibaHtml5(),this.onDeviceCreation(new Html5Device(this.info));case TECHNOLOGY.CEHTML:return this.setupToshibaCEhtml(),this.onDeviceCreation(new CEhtmlDevice(this.info))}},setupToshibaCEhtml:function(){this.info.useVideoSourceObject=!0,CEhtmlDevice=CEhtmlDevice.extend({createKeyHandler:function(){return this.keyHandler=new ToshibaKeyHandler,this.keyHandler},createPlayer:function(){return this.player=new PhilipsCEhtmlPlayer(this.info),this.player},exit:function(){window.location.href="exittoshiba.htm"}})},setupToshibaHtml5:function(){Html5Device=Html5Device.extend({createKeyHandler:function(){return this.keyHandler=new ToshibaKeyHandler,this.keyHandler},exit:function(){window.location.href="exittoshiba.htm"}})}}),LoeweDeviceFactory=DeviceFactory.extend({initialize:function(_info){this.info=_info,this.info.vendor=VENDOR.LOEWE,this.info.useVideoSourceObject=!0},createDevice:function(){return this.setupLoewe(),this.onDeviceCreation(new Html5Device(this.info))},setupLoewe:function(){Html5Device=Html5Device.extend({exit:function(){window.close()}})}}),WdDevice=Html5Device.extend({initialize:function(_info){this.supr(_info)},createKeyHandler:function(){return this.keyHandler=new WdKeyHandler(this.info),this.keyHandler},exit:function(){deviceInfo&&"function"==typeof deviceInfo.exitBrowser&&deviceInfo.exitBrowser()}}),NOT_AVAILABLE="n.a.",VENDOR={UNKNOWN:"unknown",SAMSUNG:"samsung",VIDEOWEB:"videoweb",ABOX42:"abox42",TECHNISAT:"technisat",INVERTO:"inverto",BOXEE:"boxee",SONY:"sony",LOEWE:"loewe",LG:"lg",WD:"wd",PHILIPS:"nettv",SMART:"smart",PANASONIC:"panasonic",TOSHIBA:"toshiba",OPPO:"oppo",AMAZON:"amazon",GOOGLE:"google",SWISSCOM:"swisscom"},TECHNOLOGY={HTML5:"html5Device",CEHTML:"cehtmlDevice",PROP:"proprietaryDevice"},PLATFORM={GOOGLETV:"googletv",OPERATVSTORE:"operatvstore",FIRETV:"firetv",ANDROIDTV:"androidtv",TIZEN:"tizen"},DEVICE_TYPE={TV:"tv",BDP:"bluraydiscplayer",STB:"settopbox",HT:"hometheatersystem",MC:"mediacenter",PC_CHROME:"pcchrome",PC_OPERA:"pcopera",PC_FIREFOX:"pcfirefox",PC_SAFARI:"pcsafari",EMU:"emulator"},DeviceDetection=DeviceFactory.extend({initialize:function(){this.info={userAgent:"",windowLocation:"",url:"",hash:""},this.activeDeviceFactory=null},createDeviceInfo:function(params){this.info.userAgent=navigator.userAgent,this.info.windowLocation=window.location.search,this.info.url=document.URL,this.info.vendor=VENDOR.UNKNOWN,this.info.platform=NOT_AVAILABLE,this.info.type=NOT_AVAILABLE,this.info.params=params||{},this.info.hash=window.location.hash?window.location.hash:""},createDevice:function(params){return this.createDeviceByHash(params)},createDeviceByHash:function(params){return this.createDeviceInfo(params),this.checkDeviceByHash("androidtv")?(this.activeDeviceFactory=new AndroidTVDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.info.windowLocation&&this.info.windowLocation.length>0&&/^.*modelid=.*$/.test(this.info.windowLocation)||/^.*Tizen.*$/.test(this.info.userAgent)?(this.activeDeviceFactory=new SamsungDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("sony")?(this.activeDeviceFactory=new SonyDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("googletv")?(this.activeDeviceFactory=new GoogleTVDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("opera")?(this.activeDeviceFactory=new OperaTVStoreDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("lg")&&this.checkDeviceByUserAgent(/^.*LG\sNetCast\.(TV|Media)-20[1-9][1-9].*$/g,!1,!0)?(this.activeDeviceFactory=new LGDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("panasonic")&&this.checkDeviceByUserAgent("Viera",!1)?(this.activeDeviceFactory=new PanasonicDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("nettv")&&this.checkDeviceByUserAgent("NETTV",!1)?(this.activeDeviceFactory=new PhilipsDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("toshiba")?(this.activeDeviceFactory=new ToshibaDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("oppo")?(this.activeDeviceFactory=new OppoDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("firetv")?(this.activeDeviceFactory=new FireTVDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("TechniSat")?(this.activeDeviceFactory=new TechnisatDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("loewe")?(this.activeDeviceFactory=new LoeweDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("videoweb",!0)?(this.info.vendor=VENDOR.VIDEOWEB,new CEhtmlDevice(this.info)):this.checkDeviceByUserAgent("ABox42-B12",!1)?(this.info.vendor=VENDOR.ABOX42,new CEhtmlDevice(this.info)):this.createFallBackDevice(params)},createDeviceByUserAgent:function(params){return this.createDeviceInfo(params),this.info.windowLocation&&this.info.windowLocation.length>0&&/^.*modelid=.*$/.test(this.info.windowLocation)||/^.*Tizen.*$/.test(this.info.userAgent)?(this.info.vendor=VENDOR.SAMSUNG,this.activeDeviceFactory=new SamsungDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("GoogleTV",!1)?(this.activeDeviceFactory=new GoogleTVDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent(/^.*LG\sNetCast\.(TV|Media)-20[1-9][1-9].*$/g,!1,!0)||this.checkDeviceByUserAgent("Web0S",!1)?(this.activeDeviceFactory=new LGDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("Viera",!1)?(this.activeDeviceFactory=new PanasonicDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("NETTV",!1)||this.checkDeviceByUserAgent("philips",!0)?(this.activeDeviceFactory=new PhilipsDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("SonyCEBrowser",!1)?(this.activeDeviceFactory=new SonyDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("Opera TV Store",!1)?(this.activeDeviceFactory=new OperaTVStoreDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("TOSHIBA",!1)?(this.activeDeviceFactory=new ToshibaDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("TechniSat")?(this.activeDeviceFactory=new TechnisatDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByUserAgent("videoweb",!0)?(this.info.vendor=VENDOR.VIDEOWEB,new CEhtmlDevice(this.info)):this.checkDeviceByUserAgent("ABox42-B12",!1)?(this.info.vendor=VENDOR.ABOX42,new CEhtmlDevice(this.info)):this.createFallBackDevice(params)},createFallBackDevice:function(params){return this.checkDeviceByHash("androidtv")?(this.activeDeviceFactory=new AndroidTVDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("firetv")?(this.activeDeviceFactory=new FireTVDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("development")||this.checkDeviceByUserAgent("Chrome",!1)||this.checkDeviceByUserAgent("Firefox",!1)?(this.activeDeviceFactory=new DevelopmentDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):"samsung"==params.fallback?(this.activeDeviceFactory=new SamsungDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):"philips"==params.fallback?(this.activeDeviceFactory=new PhilipsDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):this.checkDeviceByHash("technisat")?(this.activeDeviceFactory=new TechnisatDeviceFactory(this.info),this.activeDeviceFactory.createDevice()):"cehtml"==params.fallback?(this.info.vendor=VENDOR.CEHTML,new CEhtmlDevice(this.info)):"html5"==params.fallback?(this.info.vendor=VENDOR.HTML5,new Html5Device(this.info)):new Device(this.info)}}),Advertisement=klass({initialize:function(){this.trackings=[],this.percentTrackings=[],this.videos=[],this.duration=0,this.wrapperUrl=null,this.imageCache=[],this.fallback=!1},getTrackingsForName:function(name){var matching=[];return _.each(this.trackings,function(entry){entry.key==name&&matching.push(entry.url)}),matching},appendTrackingForName:function(track,url){null!=url&&url.length>0&&this.trackings.push({key:track,url:url})},sendTrackingsByName:function(name){var self=this,matching=[];return _.each(this.trackings,function(entry,index){entry.key==name&&(self.sendTrackByUrl(entry.url),delete self.trackings[index])}),matching},appendTrackingForPercent:function(percent,url){null==this.percentTrackings[percent]&&(this.percentTrackings[percent]=[]),this.percentTrackings[percent].push(url)},getTrackingsForPercent:function(percent){var trackings=this.percentTrackings[percent];return(void 0==trackings||null==trackings)&&(trackings=[]),trackings},sendTrackingsByPercent:function(percent){var self=this,pending=this.getPendingTrackings(percent);_.each(pending,function(value){_.each(value.urls,function(url){self.sendTrackByUrl(url)}),self.removePercentTrackings([value.percent])})},getPendingTrackings:function(percent){var result=[];return _.each(this.percentTrackings,function(value,key){percent>=key&&null!=value&&void 0!=value&&result.push({percent:key,urls:value})}),result},removePercentTrackings:function(percents){var self=this;_.each(percents,function(percent){self.percentTrackings[percent]=null})},sendTrackByUrl:function(url){var image=document.createElement("img");image.src=url,this.imageCache.push(image)>30&&this.imageCache.shift()},getVideoUrl:function(){return this.videos.length>0?this.videos[0].url:null},isEmpty:function(){return 1==this.duration||0==this.videos.length}}),AdParser=klass({initialize:function(dom,ad){this.dom=dom,this.errors=[],this.ad=null==ad||void 0==ad?new Advertisement:ad},parse:function(){return this.ad},getText:function(node){if("function"==typeof node.item&&(node=node.item(0)),null==node||null==node.firstChild)return null;var text="";return _.each(node.childNodes,function(node){text+=node.data}),Util.trim(text)},getElementByPath:function(dom,select){var names=select.split("/"),result=dom;for(var i in names){if(null==result||0==result.length)return null;"function"==typeof result.item&&(result=result.item(0)),result=result.getElementsByTagName(names[i])}return result}}),EmptyParser=AdParser.extend({}).methods({}),SmartclipParser=AdParser.extend({}).methods({parse:function(){var adDetails=this.getElementByPath(this.dom,"ad_details").item(0),url=adDetails.getAttribute("imageUrl"),m=url.match(/.*\.([^\.]*)/),type="";m&&(type=m[1]);var data={width:adDetails.getAttribute("width"),height:adDetails.getAttribute("height"),url:url,type:type};this.ad.videos.push(data);var trackings=this.getElementByPath(adDetails,"agencyTracker");if(null!=trackings&&trackings.length>0)for(var i=0;i<trackings.length;i++){var tracker=trackings.item(i),percent=tracker.getAttribute("progress"),url=Util.trim(tracker.getAttribute("url"));url.length>0&&this.ad.appendTrackingForPercent(percent,url)}return this.ad}}),Vast2Parser=AdParser.extend({}).methods({parse:function(){var wrapper=this.getElementByPath(this.dom,"Ad/Wrapper"),inline=this.getElementByPath(this.dom,"Ad/InLine");return null!==inline&&inline.length>0?this.parseInline(inline):null!==wrapper&&wrapper.length>0&&this.parseWrapper(wrapper),this.ad},parseInline:function(dom){var fallback=this.getElementByPath(dom,"Extensions/Extension/Fallback");null!==fallback&&fallback.length>0&&"true"==this.getText(fallback.item(0))?(this.ad.fallback=!0,this.addImpressions(dom)):(this.addVideosToAd(dom),this.addTrackingToAd(dom))},parseWrapper:function(dom){this.addTrackingToAd(dom);var wrapperUrl=this.getElementByPath(dom,"VASTAdTagURI");null!==wrapperUrl&&wrapperUrl.length>0&&(this.ad.wrapperUrl=this.getText(wrapperUrl[0]))},addImpressions:function(dom){var impressions=this.getElementByPath(dom,"Impression");if(null!==impressions&&impressions.length>0)for(var i=0;i<impressions.length;i++)this.ad.appendTrackingForPercent(0,this.getText(impressions.item(i)))},addTrackingToAd:function(dom){this.addImpressions(dom);var errors=this.getElementByPath(dom,"Error");if(null!==errors&&errors.length>0)for(var i=0;i<errors.length;i++)url=this.getText(errors.item(i)),this.ad.appendTrackingForName("errors",url);var trackings=this.getElementByPath(dom,"Creatives/Creative/Linear/TrackingEvents/Tracking");if(null!==trackings&&trackings.length>0)for(var i=0;i<trackings.length;i++){tracking=trackings.item(i);var event=tracking.getAttribute("event");"start"==event?this.ad.appendTrackingForPercent(0,this.getText(tracking)):"firstQuartile"==event?this.ad.appendTrackingForPercent(25,this.getText(tracking)):"midpoint"==event?this.ad.appendTrackingForPercent(50,this.getText(tracking)):"thirdQuartile"==event?this.ad.appendTrackingForPercent(75,this.getText(tracking)):"complete"==event?this.ad.appendTrackingForPercent(100,this.getText(tracking)):"fullscreen"==event&&this.ad.appendTrackingForName("track_fullscreen",this.getText(tracking))}var videoClicks=this.getElementByPath(dom,"Creatives/Creative/Linear/VideoClicks/ClickThrough");null!==videoClicks&&videoClicks.length>0&&this.ad.appendTrackingForName("click_through",this.getText(videoClicks.item(0)));var clickTracking=this.getElementByPath(dom,"Creatives/Creative/Linear/VideoClicks/ClickTracking");if(null!==clickTracking&&clickTracking.length>0)for(var v=0;v<clickTracking.length;v++)this.ad.appendTrackingForName("click_tracking",this.getText(clickTracking.item(v)))},addVideosToAd:function(dom){var videos=this.getElementByPath(dom,"Creatives/Creative/Linear");
if(null!==videos&&videos.length>0)for(var i=0;i<videos.length;i++){var mediaFiles=this.getElementByPath(videos.item(i),"MediaFiles/MediaFile");if(null!==mediaFiles&&mediaFiles.length>0)for(var v=0;v<mediaFiles.length;v++){var mediaFile=mediaFiles.item(v);if(url=Util.trim(this.getText(mediaFile)),url.length>0){var data={delivery:mediaFile.getAttribute("delivery"),bitrate:parseInt(mediaFile.getAttribute("bitrate"),10),width:mediaFile.getAttribute("width"),height:mediaFile.getAttribute("height"),type:mediaFile.getAttribute("type"),url:url};this.ad.videos.push(data)}}var durations=this.getElementByPath(videos.item(i),"Duration");if(null!==durations&&durations.length>0){var durationText=this.getText(durations[0]),match=durationText.match(/^(\d\d):(\d\d):(\d\d)$/);if(match){var durationInt=60*parseInt(match[1],10)*60+60*parseInt(match[2],10)+parseInt(match[3],10);this.ad.duration=durationInt}match=durationText.match(/^(\d*)$/),match&&(this.ad.duration=parseInt(durationText,10))}}}}),ParserFactory={getParser:function(dom,ad){return null==dom?new EmptyParser(ad):"VAST"==dom.nodeName?new Vast2Parser(dom,ad):"content"==dom.nodeName?new SmartclipParser(dom,ad):new EmptyParser}},AdController=klass({initialize:function(videos){this.videos=videos,this.currentPosition=0,this.duration=0,this.currentAd=null,this.skipAd=!1},getNextVideo:function(callback){var self=this;if(this.currentAd=null,this.currentPosition>=this.videos.length)callback(null);else{var current=this.videos[this.currentPosition];this.currentPosition+=1,null==current?callback(null):null!=current.adUrl?this.loadAd(current.adUrl,function(ad){ad?ad.isEmpty()?(ad.fallback&&ad.sendTrackingsByPercent(0),self.getNextVideo(callback)):(self.currentAd=ad,callback({url:ad.getVideoUrl(),type:"ad",ad:ad})):self.getNextVideo(callback)}):callback(null!=current.videoUrl?{url:current.videoUrl,type:"video"}:null)}},cancelAd:function(){this.currentAd=null},updatePlayTime:function(time){this.currentTime=time,this.sendTrackings()},videoFinished:function(){this.updatePlayTime(this.duration)},setDuration:function(duration){this.duration=duration},sendTrackingsForName:function(name){null!=this.currentAd&&this.currentAd.sendTrackingsByName(name)},sendTrackings:function(){if(null!=this.currentAd){var percent=this.currentTime/(this.duration/100);percent>95&&(percent=100),this.currentAd.sendTrackingsByPercent(percent)}},loadAd:function(url,callback,ad){if(this.skipAd||null==url||void 0==url||0==url.length)callback(new Advertisement);else{var self=this,timeoutSend=!1,timer=setTimeout(function(){timeoutSend=!0,self.jsonpCallback(null,callback,ad)},2e3);window.adCallback=function(data){clearTimeout(timer),timeoutSend||(window.adCallback=null,self.jsonpCallback(data,callback,ad))},this.adCallback=window.adCallback,$.ajax({dataType:"jsonp",jsonp:!1,cache:!0,url:url,crossDomain:!0})}},jsonpCallback:function(data,callback,ad){var ad=this.parseJsonpResult(data,ad);if(null!=ad.wrapperUrl&&ad.wrapperUrl.length>0){var url=ad.wrapperUrl;ad.wrapperUrl=null,this.loadAd(url,callback,ad)}else callback(ad)},parseJsonpResult:function(data,ad){try{var responseDoc=(new DOMParser).parseFromString(data.contents,"text/xml"),parser=ParserFactory.getParser(responseDoc.firstChild,ad);return parser.parse(responseDoc.firstChild)}catch(e){return new Advertisement}}}),TrackingFactory=klass({initialize:function(){},createTracker:function(_options){switch(this.trackerType=_options.type?_options.type:"",this.trackerType){case"ga":return"undefined"==typeof _options.accountString||""==_options.accountString?new NoTracker(_options,"There is no account string given for google analytics!"):new GATracker(_options);default:return new NoTracker(_options,"No tracker type specified!")}}}),NoTracker=klass({initialize:function(_options,_message){Logger.log("--------- TRACKER -----------------------------------------"),Logger.log("Failed to initialize any specific tracker!"),Logger.log("INFO: "+_message),Logger.log("-- Possible options:"),Logger.log("---- Google Analytics:"),Logger.log("------ (mandatory) type: 'ga'"),Logger.log("------ (mandatory) accountString: 'UA-xxxxxxxx-x'"),Logger.log("-- Given options:");for(option in _options)Logger.log("-- "+option+": "+_options[option]);Logger.log("-----------------------------------------------------------")},trackPage:function(){Logger.log("WARNING: tracker is not set up!")},trackEvent:function(){Logger.log("WARNING: tracker is not set up!")}}),GATracker=klass({initialize:function(_options){this.accountString=_options.accountString,this.anonymizedIP=_options.anonymizedIP?_options.anonymizedIP:!1,this.encoding="UTF-8",this.version="5.3.2",this.domainHash="1",this.uniqueID=Math.floor(1e5*Math.random(10))+"00145214523",this.timeFirstVisit=(new Date).getTime(),this.timePrevVisit=(new Date).getTime(),this.sessionCount="15",this.timeCookieSet=(new Date).getTime(),this.sessionNo="1",this.campaignNo="1",this.campaignSrc="(direct)",this.campaignName="(direct)",this.campaignMedium="(none)",this.urlBasics="https://ssl.google-analytics.com/__utm.gif?utmac="+this.accountString+"&utmcs="+this.encoding+"&utmwv="+this.version+(this.anonymizedIP?"&aip=1":"")},getCookieString:function(){var utma="__utma%3D"+this.domainHash+"."+this.uniqueID+"."+this.timeFirstVisit+"."+this.timePrevVisit+"."+(new Date).getTime()+"."+this.sessionCount+"%3B%2B",utmz="__utmz%3D"+this.domainHash+"."+this.timeCookieSet+"."+this.sessionNo+"."+this.campaignNo+".utmcsr%3D"+this.campaignSrc+"%7Cutmccn%3D"+this.campaignName+"%7Cutmccn%3D"+this.campaignMedium+"%3B";return"&utmcc="+utma+utmz},getTrackingBaseURL:function(){var randomId=Math.floor(1e5*Math.random(10)),baseURL=this.urlBasics+this.getCookieString()+"&utmn="+randomId+"&utmhid="+randomId;return baseURL},sendTracking:function(_trackingURL){Logger.log("GATracker.sendTracking to "+_trackingURL);var trackingImage=document.createElement("img");trackingImage.src=_trackingURL},getCustomVarString:function(_custom_vars){if(Logger.log("GATracker.getCustomVarString"),_custom_vars){for(var slots_names="",slots_values="",slots_scopes="",i=0;i<_custom_vars.length;i++){var seperator=i==_custom_vars.length-1?"":"*",slot=_custom_vars[i].slot,name=_custom_vars[i].name,value=_custom_vars[i].value,scope=_custom_vars[i].scope?_custom_vars[i].scope:3;slots_names+=slot+"!"+name+seperator,slots_values+=slot+"!"+value+seperator,slots_scopes+=slot+"!"+scope+seperator}return encodeURIComponent("8("+slots_names+")9("+slots_values+")11("+slots_scopes+")")}return""},trackPage:function(_options){var url=_options.url?_options.url:"undefined",title=_options.title?_options.title:"undefined",custom_vars=_options.custom_vars?"&utme="+this.getCustomVarString(_options.custom_vars):"",trackingURL=this.getTrackingBaseURL()+"&utmp="+url+"&utmdt="+title+custom_vars;this.sendTracking(trackingURL)},trackEvent:function(_options){var category=_options.category?_options.category:"undefined",action=_options.action?_options.action:"undefined",label=_options.label?_options.label:!1,pageTitle=_options.pageTitle?_options.pageTitle:"Event",custom_vars=_options.custom_vars?this.getCustomVarString(_options.custom_vars):"",eventString="5("+category+"*"+action+(label?"*"+label:"")+")",trackingURL=this.getTrackingBaseURL()+"&utmt=event&utme="+encodeURIComponent(eventString)+custom_vars+"&utmdt="+pageTitle;this.sendTracking(trackingURL)}});